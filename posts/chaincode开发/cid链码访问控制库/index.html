<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <meta charset="UTF-8" />

    <meta name="generator" content="Hugo 0.74.3" /><meta name="theme-color" content="#fff" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>链码的访问控制(cid库) | VegeBun-csj’s blog</title>

    <link rel="stylesheet" href="/css/meme.min.b0d324d4edc32df95e3dfd01e584c8f7650a0a1ccc54668a2b2afb5736470a5e.css" integrity="sha256-sNMk1O3DLflePf0B5YTI92UKChzMVGaKKyr7VzZHCl4=" />

    
    
        <script src="/js/meme.min.fef3f4116ec8ee1ae0f93c6665f15904241c992e1a8ffb62b89fa18f3389bcb6.js" integrity="sha256-/vP0EW7I7hrg&#43;TxmZfFZBCQcmS4aj/tiuJ&#43;hjzOJvLY="></script>

    

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" /></noscript>

    <meta name="author" content="Bun" /><meta name="description" content="Client Identity Chaincode Library（客户端标识链代码库） The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the……" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#2a6df4" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="VegeBun-csj’s blog" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="VegeBun-csj’s blog" />
    <meta name="msapplication-starturl" content="../../../" />
    <meta name="msapplication-TileColor" content="#fff" />
    <meta name="msapplication-TileImage" content="../../../icons/mstile-150x150.png" />
    <link rel="manifest" href="/manifest.json" />

    
    

    
    <link rel="canonical" href="https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/" />
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "datePublished": "2020-08-29T13:27:15+08:00",
        "dateModified": "2020-10-16T19:30:45+08:00",
        "url": "https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/",
        "headline": "链码的访问控制(cid库)",
        "description": "Client Identity Chaincode Library（客户端标识链代码库） The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the……",
        "inLanguage" : "zh-CN",
        "articleSection": "posts",
        "wordCount":  6992 ,
        "image": "https://VegeBun-csj.github.io/icons/apple-touch-icon.png",
        "author": {
            "@type": "Person",
            "description": "make progress every day",
            "email": "1071285741@qq.com",
            "image": "https://VegeBun-csj.github.io/icons/apple-touch-icon.png",
            "url": "https://VegeBun-csj.github.io",
            "name": "Bun"
        },
        "license": "[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)",
        "publisher": {
            "@type": "Organization",
            "name": "VegeBun-csj’s blog",
            "logo": {
                "@type": "ImageObject",
                "url": "https://VegeBun-csj.github.io/icons/apple-touch-icon.png"
            },
            "url": "https://VegeBun-csj.github.io/"
        },
        "mainEntityOfPage": {
            "@type": "WebSite",
            "@id": "https://VegeBun-csj.github.io/"
        }
    }
</script>

    

<meta name="twitter:card" content="summary" />

<meta name="twitter:site" content="@bun" />
<meta name="twitter:creator" content="@Bun" />

    



<meta property="og:title" content="链码的访问控制(cid库)" />
<meta property="og:description" content="Client Identity Chaincode Library（客户端标识链代码库） The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the……" />
<meta property="og:url" content="https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/" />
<meta property="og:site_name" content="VegeBun-csj’s blog" />
<meta property="og:locale" content="zh" /><meta property="og:image" content="https://VegeBun-csj.github.io/icons/apple-touch-icon.png" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-08-29T13:27:15&#43;08:00" />
    <meta property="article:modified_time" content="2020-10-16T19:30:45&#43;08:00" />
    
    <meta property="article:section" content="posts" />



    
</head>

    <body>
        <div class="container">
            
    <header class="header">
        
            <div class="header-wrapper">
                <div class="header-inner single">
                    
    <div class="site-brand">
        
            <a href="/" class="brand">VegeBun-csj’s blog</a>
        
    </div>

                    <nav class="nav">
    <ul class="menu" id="menu">
        
            
        
        
        
        
            
                <li class="menu-item"><a href="/posts/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">文章</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon th"><path d="M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"/></svg><span class="menu-item-name">分类</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/tags/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg><span class="menu-item-name">标签</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/about/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class="menu-item-name">关于</span></a>
                </li>
            
        
            
                
                    
                    
                        <li class="menu-item">
                            <a id="theme-switcher" href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5l48.8-97.5a18 18 0 0128 0l48.8 97.5 103.4 -34.5a18 18 0 0119.8 19.8l-34.5 103.4l97.5 48.8a18 18 0 010 28l-97.5 48.8 34.5 103.4a18 18 0 01-19.8 19.8l-103.4-34.5-48.8 97.5a18 18 0 01-28 0l-48.8-97.5l-103.4 34.5a18 18 0 01-19.8-19.8l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8-34.5-103.4a18 18 0 0119.8-19.8zM256 128a128 128 0 10.01 0M256 160a96 96 0 10.01 0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412a256 256 0 10154-407a11.5 11.5 0 00-5 20a201.5 201.5 0 01-134 374a11.5 11.5 0 00-15 13"/></svg></a>
                        </li>
                    
                
            
        
            
                
            
        
    </ul>
</nav>

                    
                </div>
            </div>
            
    <input type="checkbox" id="nav-toggle" aria-hidden="true" />
    <label for="nav-toggle" class="nav-toggle"></label>
    <label for="nav-toggle" class="nav-curtain"></label>


        
    </header>




            
            
    <main class="main single" id="main">
    <div class="main-inner">

        

        <article class="content post" data-align="justify" data-type="posts" data-toc-num="true">

            <h1 class="post-title">链码的访问控制(cid库)</h1>

            

            
                
            

            
                

<div class="post-meta">
    
        
        <time datetime="2020-08-29T13:27:15&#43;08:00" class="post-meta-item published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;2020.8.29</time>
    
    
        
        <time datetime="2020-10-16T19:30:45&#43;08:00" class="post-meta-item modified"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M400 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 400H54a6 6 0 0 1-6-6V160h352v298a6 6 0 0 1-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2020.10.16</time>
    
    
    
        
        
        
            
                <span class="post-meta-item category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>&nbsp;<a href="/categories/hyperledger-fabric-chincode%E5%BC%80%E5%8F%91/" class="category-link">Hyperledger Fabric--chincode开发</a></span>
            
        
    
    
        
        <span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;6992</span>
    
    
        
        <span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;14&nbsp;分钟</span>
    
    
    
</div>

            

            <div class="post-body">
              <h1 id="client-identity-chaincode-library客户端标识链代码库"><a href="#client-identity-chaincode-library客户端标识链代码库" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Client Identity Chaincode Library（客户端标识链代码库）</h1>
<p>The client identity chaincode library enables you to write chaincode which
makes access control decisions based on the identity of the client
(i.e. the invoker of the chaincode).  In particular, you may make access
control decisions based on either or both of the following associated with
the client:</p>
<p>客户端标识链码库使您能够编写基于客户端标识(即链码的调用者)进行访问控制决策的链码。
特别是，您可以根据与客户端关联的下列任一项或两项进行访问控制决策</p>
<ul>
<li>the client identity's MSP (Membership Service Provider) ID（客户端身份的MSP(会员服务提供者)ID）</li>
<li>an attribute associated with the client identity（与客户端身份关联的属性）</li>
</ul>
<p>Attributes are simply name and value pairs associated with an identity.
For example, <code>email=me@gmail.com</code> indicates an identity has the <code>email</code>
attribute with a value of <code>me@gmail.com</code>.</p>
<p>属性只是与身份关联的键值对。例如，email=me@gmail.com表示一个有着email属性，值为me@gmail.com的身份</p>
<h2 id="using-the-client-identity-chaincode-library使用方法"><a href="#using-the-client-identity-chaincode-library使用方法" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Using the client identity chaincode library（使用方法）</h2>
<p>This section describes how to use the client identity chaincode library.</p>
<p>All code samples below assume two things:</p>
<ol>
<li>
<p>The type of the <code>stub</code> variable is <code>ChaincodeStubInterface</code> as passed
to your chaincode. 将stub作为<code>ChaincodeStubInterface</code>接口传入chaincode</p>
</li>
<li>
<p>You have added the following import statement to your chaincode.  导入相关的包</p>
<pre><code>import &quot;github.com/hyperledger/fabric/core/chaincode/lib/cid&quot;
</code></pre></li>
</ol>
<h4 id="getting-the-clients-id获取客户端id"><a href="#getting-the-clients-id获取客户端id" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Getting the client's ID（获取客户端id）</h4>
<p>The following demonstrates how to get an ID for the client which is guaranteed
to be unique within the MSP:  下面演示了如何为客户端获取一个ID，它保证在MSP中是唯一的:</p>
<pre><code>id, err := cid.GetID(stub)
</code></pre><h4 id="getting-the-msp-id获取mspid"><a href="#getting-the-msp-id获取mspid" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Getting the MSP ID（获取mspid）</h4>
<p>The following demonstrates how to get the MSP ID of the client's identity: 下面演示如何获取客户端身份的MSP ID:</p>
<pre><code>mspid, err := cid.GetMSPID(stub)
</code></pre><h4 id="getting-an-attribute-value获取属性值"><a href="#getting-an-attribute-value获取属性值" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Getting an attribute value（获取属性值）</h4>
<p>The following demonstrates how to get the value of the <em>attr1</em> attribute:下面演示了如何获取attr1属性的值:</p>
<pre><code>val, ok, err := cid.GetAttributeValue(stub, &quot;attr1&quot;)
if err != nil {
   // There was an error trying to retrieve the attribute
}
if !ok {
   // The client identity does not possess the attribute
}
// Do something with the value of 'val'
</code></pre><h4 id="asserting-an-attribute-value-断言属性值判断attr的key是否为对应的value"><a href="#asserting-an-attribute-value-断言属性值判断attr的key是否为对应的value" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Asserting an attribute value 断言属性值（判断Attr的key是否为对应的value）</h4>
<p>Often all you want to do is to make an access control decision based on the value
of an attribute, i.e. to assert the value of an attribute.  For example, the following
will return an error if the client does not have the <code>myapp.admin</code> attribute
with a value of <code>true</code>:p</p>
<p>通常，您想做的就是根据属性的值做出访问控制决策，即断言属性的值。例如，如果客户端myapp.admin的属性值不为true，下面的代码将返回一个错误。</p>
<pre><code>err := cid.AssertAttributeValue(stub, &quot;myapp.admin&quot;, &quot;true&quot;)
if err != nil {
   // Return an error
}
</code></pre><p>This is effectively using attributes to implement role-based access control,
or RBAC for short.</p>
<p>这是有效地使用属性来实现基于角色的访问控制，简称RBAC。</p>
<h4 id="getting-the-clients-x509-certificate------------获取客户端的x509证书"><a href="#getting-the-clients-x509-certificate------------获取客户端的x509证书" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Getting the client's X509 certificate            获取客户端的X509证书</h4>
<p>The following demonstrates how to get the X509 certificate of the client, or
nil if the client's identity was not based on an X509 certificate:</p>
<p>下面演示了如何获得客户端的X509证书，如果客户端的身份不是基于X509证书，则为nil:</p>
<pre><code>cert, err := cid.GetX509Certificate(stub)
</code></pre><p>Note that both <code>cert</code> and <code>err</code> may be nil as will be the case if the identity
is not using an X509 certificate.</p>
<p>请注意，cert和err都可能为nil，如果客户端身份没有使用X509证书，则将出现这种情况。</p>
<h4 id="performing-multiple-operations-more-efficiently更有效地执行多个操作"><a href="#performing-multiple-operations-more-efficiently更有效地执行多个操作" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Performing multiple operations more efficiently（更有效地执行多个操作）</h4>
<p>Sometimes you may need to perform multiple operations in order to make an access
decision.  For example, the following demonstrates how to grant access to
identities with MSP <em>org1MSP</em> and <em>attr1</em> OR with MSP <em>org1MSP</em> and <em>attr2</em>.</p>
<p>有时您可能需要执行多个操作才能做出访问决策。例如，下面演示了如何使用MSP org1MSP和attr1或MSP org1MSP和attr2授予身份的访问权。</p>
<pre><code>// Get the client ID object
id, err := cid.New(stub)
if err != nil {
   // Handle error
}
mspid, err := id.GetMSPID()
if err != nil {
   // Handle error
}
switch mspid {
   case &quot;org1MSP&quot;:
      err = id.AssertAttributeValue(&quot;attr1&quot;, &quot;true&quot;)
   case &quot;org2MSP&quot;:
      err = id.AssertAttributeValue(&quot;attr2&quot;, &quot;true&quot;)
   default:
      err = errors.New(&quot;Wrong MSP&quot;)
}
</code></pre><p>Although it is not required, it is more efficient to make the <code>cid.New</code> call
to get the ClientIdentity object if you need to perform multiple operations,
as demonstrated above.</p>
<p>虽然不是必需的。如果需要执行多个操作，用<code>cid.New</code>调用来获取ClientIdentity对象是非常有效的，如上所示。</p>
<h2 id="adding-attributes-to-identities向身份添加属性"><a href="#adding-attributes-to-identities向身份添加属性" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Adding Attributes to Identities（向身份添加属性）</h2>
<p>This section describes how to add custom attributes to certificates when
using Hyperledger Fabric CA as well as when using an external CA.</p>
<p>本节描述如何在使用Hyperledger Fabric CA时以及在使用外部CA时向证书添加自定义属性。</p>
<h4 id="managing-attributes-with-fabric-ca使用fabric-ca管理属性"><a href="#managing-attributes-with-fabric-ca使用fabric-ca管理属性" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Managing attributes with Fabric CA（使用Fabric CA管理属性）</h4>
<p>There are two methods of adding attributes to an enrollment certificate
with fabric-ca:</p>
<p>（使用fabric-ca向注册证书添加属性有两种方法:）</p>
<ol>
<li>
<p>When you register an identity, you can specify that an enrollment certificate
issued for the identity should by default contain an attribute.  This behavior
can be overridden at enrollment time, but this is useful for establishing
default behavior and, assuming registration occurs outside of your application,
does not require any application change.</p>
<p>当您注册一个身份时，您可以指定为该身份颁发的登记证书（e-cert）在缺省情况下应该包含一个属性(attribute)。可以在注册时覆盖此行为，但这对于建立默认行为非常有用，并且假设注册发生在应用程序之外，不需要对应用程序进行任何更改。</p>
<p>The following shows how to register <em>user1</em> with two attributes:
<em>app1Admin</em> and <em>email</em>.
The &quot;:ecert&quot; suffix causes the <em>appAdmin</em> attribute to be inserted into user1's
enrollment certificate by default.  The <em>email</em> attribute is not added
to the enrollment certificate by default.</p>
<p>下面展示了如何使用两个属性 app1Admin和email注册user1。“:ecert”后缀在默认情况下会将appAdmin属性插入user1的登记证书（e-cert）中。默认情况下，未将email属性添加到登记证书(e-cert)中</p>
<pre><code>fabric-ca-client register --id.name user1 --id.secret user1pw --id.type user --id.affiliation org1 --id.attrs 'app1Admin=true:ecert,email=user1@gmail.com'
</code></pre></li>
<li>
<p>When you enroll an identity, you may request that one or more attributes
be added to the certificate.
For each attribute requested, you may specify whether the attribute is
optional or not.  If it is not optional but does not exist for the identity,
enrollment fails.</p>
<p>当您登记一个身份时，您可以请求将一个或多个属性添加到证书中。对于请求的每个属性，您可以指定该属性是否是可选的。如果该身份的属性是必选的，但不存在，则登记失败。</p>
<p>The following shows how to enroll <em>user1</em> with the <em>email</em> attribute,
without the <em>app1Admin</em> attribute and optionally with the <em>phone</em> attribute
(if the user possesses <em>phone</em> attribute).</p>
<p>下面展示了如何使用email属性注册user1，不使用app1Admin属性，也可以使用phone属性(如果用户拥有phone属性)。</p>
<pre><code>fabric-ca-client enroll -u http://user1:user1pw@localhost:7054 --enrollment.attrs &quot;email,phone:opt&quot;
</code></pre></li>
</ol>
<h4 id="attribute-format-in-a-certificate-证书中的属性格式"><a href="#attribute-format-in-a-certificate-证书中的属性格式" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Attribute format in a certificate （证书中的属性格式）</h4>
<p>Attributes are stored inside an X509 certificate as an extension with an
ASN.1 OID (Abstract Syntax Notation Object IDentifier)
of <code>1.2.3.4.5.6.7.8.1</code>.  The value of the extension is a JSON string of the
form <code>{&quot;attrs&quot;:{&lt;attrName&gt;:&lt;attrValue}}</code>.  The following is a sample of a
certificate which contains the <code>attr1</code> attribute with a value of <code>val1</code>.
See the final entry in the <em>X509v3 extensions</em> section.  Note also that the JSON
entry could contain multiple attributes, though this sample shows only one.</p>
<p>属性作为扩展名存储在X509证书中，其ASN.1 OID(抽象语法符号对象标识符)为1.2.3.4.5.6.7.8.1。该扩展的值是以{&quot;attrs&quot;:{<attrName>:&lt;attrValue}}（属性名，属性值这种键值对）为形式的JSON字符串。下面是一个证书示例，其中包含值为val1的attr1属性。请参阅X509v3扩展部分中的最后一项。还要注意，JSON条目可以包含多个属性，但本示例只显示了一个属性。</p>
<pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            1e:49:98:e9:f4:4f:d0:03:53:bf:36:81:c0:a0:a4:31:96:4f:52:75
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: CN=fabric-ca-server
        Validity
            Not Before: Sep  8 03:42:00 2017 GMT
            Not After : Sep  8 03:42:00 2018 GMT
        Subject: CN=MyTestUserWithAttrs
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
            EC Public Key:
                pub:
                    04:e6:07:5a:f7:09:d5:af:38:e3:f7:a2:90:77:0e:
                    32:67:5b:70:a7:37:ca:b5:c9:d8:91:77:39:ae:03:
                    a0:36:ad:72:b3:3c:89:6d:1e:f6:1b:6d:2a:88:49:
                    92:6e:6e:cc:bc:81:52:fa:19:88:18:5c:d7:6e:eb:
                    d4:73:cc:51:79
                ASN1 OID: prime256v1
        X509v3 extensions:
            X509v3 Key Usage: critical
                Certificate Sign
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                D8:28:B4:C0:BC:92:4A:D3:C3:8C:54:6C:08:86:33:10:A6:8D:83:AE
            X509v3 Authority Key Identifier:
                keyid:C4:B3:FE:76:0D:E2:DE:3C:FC:75:FB:AE:55:86:04:F0:BB:7F:F6:01

            X509v3 Subject Alternative Name:
                DNS:Anils-MacBook-Pro.local
            1.2.3.4.5.6.7.8.1:
                {&quot;attrs&quot;:{&quot;attr1&quot;:&quot;val1&quot;}}
    Signature Algorithm: ecdsa-with-SHA256
        30:45:02:21:00:fb:84:a9:65:29:b2:f4:d3:bc:1a:8b:47:92:
        5e:41:27:2d:26:ec:f7💿aa:86:46:a4:ac:da:25:be:40:1d:
        c5:02:20:08:3f:49:86:58:a7:20:48:64:4c:30:1b:da:a9:a2:
        f2:b4:16:28:f6:fd:e1:46:dd:6b:f2:3f:2f:37:4a:4c:72
</code></pre><p>If you want to use the client identity library to extract or assert attribute
values as described previously but you are not using Hyperledger Fabric CA,
then you must ensure that the certificates which are issued by your external CA
contain attributes of the form shown above.  In particular, the certificates
must contain the <code>1.2.3.4.5.6.7.8.1</code> X509v3 extension with a JSON value
containing the attribute names and values for the identity.</p>
<p>如果您想使用前面描述的客户端身份库来提取或断言属性值，但是您没有使用Hyperledger Fabric CA，那么您必须确保由您的外部CA颁发的证书包含上面所示表单的属性。特别是，证书必须包含1.2.3.4.5.6.7.8.1 X509v3扩展，其JSON值包含标识的属性名和值。</p>
<hr>
<p>下面列举一个实际使用的例子：<strong>(注意在合约中引入相关的依赖，即cid库文件，这里可以借鉴fabric-samples/chaincode/abac中的库的引用)</strong></p>
<p>此链码库cid是用来进行链码操作权限的控制的，那么，这个attrs的name-value该如何获取呢，从上面的解释中可以看到跟CA有关，所以是在我们注册用户身份的时候进行设置的，下面列举使用Node sdk进行初始化设置attrs的例子</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"> <span class="kr">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span>
     <span class="p">{</span>
       <span class="nx">affiliation</span><span class="o">:</span> <span class="s1">&#39;org1.department1&#39;</span><span class="p">,</span>
       <span class="nx">enrollmentID</span><span class="o">:</span> <span class="s1">&#39;cai&#39;</span><span class="p">,</span>
       <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;client&#39;</span><span class="p">,</span>
       <span class="nx">attrs</span><span class="o">:</span> <span class="p">[</span>					<span class="c1">//在register的传入属性中有attrs这个参数，这是一个Array数组
</span><span class="c1"></span>       <span class="p">{</span>						<span class="c1">//其中传入三个
</span><span class="c1"></span>         <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;usertype&#39;</span><span class="p">,</span>		<span class="c1">//attrs的name，也就是key
</span><span class="c1"></span>         <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;storeshop&#39;</span><span class="p">,</span>	<span class="c1">//attrs的value，也就是key对应的值
</span><span class="c1"></span>         <span class="nx">ecert</span><span class="o">:</span> <span class="kc">true</span>			<span class="c1">//ecert为true表示默认情况下应将此属性包括在注册证书中(默认)
</span><span class="c1"></span>      <span class="p">}]</span>
     <span class="p">},</span>
    <span class="nx">adminIdentity</span>
   <span class="p">);</span>
</code></pre></td></tr></table></div>
</div>
</div><p>上面就是设置了attrs的name是usertype,value是storeshop</p>
<p>链码我们是以官方的fabcar链码进行了小小的修改，地址如下：</p>
<blockquote>
<p><a href="https://github.com/VegeBun-csj/learning-chaincode/blob/master/access-control/go/fabcar.go" target="_blank" rel="noopener">https://github.com/VegeBun-csj/learning-chaincode/blob/master/access-control/go/fabcar.go</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">//根据name获取用户的attr的值
</span><span class="c1">//这里就是根据name--usertype来获取我们注册时设置的value，如果使用上面注册时的身份user进行调用就会获取到usertype对应的value是storeshop
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="nf">getAttr</span><span class="p">(</span><span class="nx">APIstub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">sc</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">,</span> <span class="nx">found</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">cid</span><span class="p">.</span><span class="nf">GetAttributeValue</span><span class="p">(</span><span class="nx">APIstub</span><span class="p">,</span> <span class="s">&#34;usertype&#34;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">found</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
  	 <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;未查询到属性值&#34;</span><span class="p">)</span>
  <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">{</span>
  	 <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;查询错误&#34;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">res</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">//类型断言 -----用来判断是否当前的操作用户的attr的key与value是否与这里指定的值匹配
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="nf">AssertAttr</span><span class="p">(</span><span class="nx">APIstub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">sc</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="nx">err</span> <span class="o">:=</span> <span class="nx">cid</span><span class="p">.</span><span class="nf">AssertAttributeValue</span><span class="p">(</span><span class="nx">APIstub</span><span class="p">,</span> <span class="s">&#34;usertype&#34;</span><span class="p">,</span> <span class="s">&#34;storeshop&#34;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;类型不是storeshop&#34;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;类型是storeshop&#34;</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></td></tr></table></div>
</div>
</div><p>演示一个在Java-SDK中通过<code>CID</code>库进行链码访问控制的例子：</p>
<p>链码地址如下：</p>
<p>fabric-SDK-Java的客户端代码为:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;songjian\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="c1">// Register the user, enroll the user, and import the new identity into the wallet.
</span><span class="c1"></span>        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>

        <span class="c1">//register的时候设置用户自定义的属性类型
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;worker&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>
        <span class="c1">//enroll的时候，指定之前register的用户中的哪些属性要加入到证书中，如果不加，后买你在链码中就读取不到
</span><span class="c1"></span>        <span class="n">EnrollmentRequest</span> <span class="n">enrollmentRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnrollmentRequest</span><span class="o">();</span>
        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Affiliation&#34;</span><span class="o">);</span>		<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.EnrollmentID&#34;</span><span class="o">);</span>	<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Type&#34;</span><span class="o">);</span>			<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">);</span>			<span class="c1">//user-defined attribute
</span><span class="c1"></span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">,</span><span class="n">enrollmentRequest</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;songjian\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table></div>
</div>
</div><blockquote>
<p>注意：在register中自定义了属性值之后，需要在最后进行Enroll的时候，将相关的属性放入<code>EnrollmentRequest</code>中，否则就会出现在链码中获取不到attribution的属性值，我这边就是Enroll的时候没加，导致我一度怀疑自己的链码出现了问题，最后看到网上大佬的才发现是这步不对，之前使用NodeSDK的时候好像没这个问题，估计是SDK不同pa。。。。也算是学到了hh</p>
</blockquote>
<p>这个例子想实现的就是，fabcar中的汽车，只有用户属性为<code>leader_car_department(汽车部门主管)</code>类型的才可以查看所有的汽车并且更改汽车的所有者,其他属性值的是看不了的，比如普通的工人<code>worker</code></p>
<p>用户属性<code>Attr</code>我们定义为<code>usertype</code>，但是<code>value</code>的值就可以有很多了，比如worker(员工).....还有其他的。。。</p>
<p>上面是注册了一个<code>Attr</code>为<code>usertype</code>，<code>value</code>为<code>worker</code>的用户<code>songjian</code>，所以这个用户是不能调用<code>queryAllCars</code>和<code>changeCarOwner</code>的</p>
<p>下面我们再注册一个用户<code>yfhuang</code>，他的类型为<code>leader_car_department(汽车部门主管)</code>,所以就可以使用<code>queryAllCars</code>和<code>changeCarOwner</code></p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;yfhuang\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="c1">// Register the user, enroll the user, and import the new identity into the wallet.
</span><span class="c1"></span>        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>

        <span class="c1">//register的时候设置用户自定义的属性类型
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;leader_car_department&#34;</span><span class="o">));</span>

        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>

        <span class="c1">//enroll的时候，指定之前register的用户中的哪些属性要加入到证书中，如果不加，后买你在链码中就读取不到
</span><span class="c1"></span>        <span class="n">EnrollmentRequest</span> <span class="n">enrollmentRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnrollmentRequest</span><span class="o">();</span>
        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Affiliation&#34;</span><span class="o">);</span>		<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.EnrollmentID&#34;</span><span class="o">);</span>	<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Type&#34;</span><span class="o">);</span>			<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">);</span>				<span class="c1">//user-defined attribute
</span><span class="c1"></span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">,</span><span class="n">enrollmentRequest</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;yfhuang\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></td></tr></table></div>
</div>
</div><p>以<code>yfhuang</code>用户进行调用</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Contract</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Gateway</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Network</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @author csj
</span><span class="cm"> * @date 2020/10/16 - 16:49
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">clientCar</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;false&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Load a file system based wallet for managing identities.
</span><span class="c1"></span>        <span class="n">Path</span> <span class="n">walletPath</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">);</span>
        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">walletPath</span><span class="o">);</span>

        <span class="c1">// load a CCP
</span><span class="c1"></span>        <span class="n">Path</span> <span class="n">networkConfigPath</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/connection-org1.yaml&#34;</span><span class="o">);</span>

        <span class="n">Gateway</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">Gateway</span><span class="o">.</span><span class="na">createBuilder</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">identity</span><span class="o">(</span><span class="n">wallet</span><span class="o">,</span> <span class="s">&#34;yfhuang&#34;</span><span class="o">).</span><span class="na">networkConfig</span><span class="o">(</span><span class="n">networkConfigPath</span><span class="o">).</span><span class="na">discovery</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

        <span class="c1">// create a gateway connection
</span><span class="c1"></span>        <span class="k">try</span> <span class="o">(</span><span class="n">Gateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">connect</span><span class="o">())</span> <span class="o">{</span>

            <span class="c1">// get the network and contract
</span><span class="c1"></span>            <span class="n">Network</span> <span class="n">network</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getNetwork</span><span class="o">(</span><span class="s">&#34;mychannel&#34;</span><span class="o">);</span>
            <span class="n">Contract</span> <span class="n">contract</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="na">getContract</span><span class="o">(</span><span class="s">&#34;fabcar&#34;</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span><span class="o">;</span>
           <span class="c1">//这个方法，如果不是用户注册属性为leader_car_department，就会抛出没有权限的错误
</span><span class="c1"></span>            <span class="n">result</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="na">evaluateTransaction</span><span class="o">(</span><span class="s">&#34;queryAllCars&#34;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">result</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table></div>
</div>
</div><p>可以看到，是可以查看到所有的汽车的：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="o">[{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR0&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;blue&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Toyota&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Prius&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Tomoko&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR1&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;red&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Ford&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Mustang&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Brad&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR2&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;green&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Hyundai&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Tucson&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Jin Soo&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR3&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;yellow&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Volkswagen&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Passat&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Max&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR4&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;black&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Tesla&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;S&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Adriana&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR5&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;purple&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Peugeot&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;205&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Michel&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR6&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;white&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Chery&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;S22L&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Aarav&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR7&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;violet&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Fiat&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Punto&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Pari&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR8&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;indigo&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Tata&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Nano&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Valeria&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR9&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;brown&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Holden&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Barina&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Shotaro&#34;</span><span class="o">}}]</span>
</code></pre></td></tr></table></div>
</div>
</div><p>以<code>songjian</code>用户进行调用：</p>
<p>可以看到爆出了权限错误</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">&#34;main&#34;</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">ContractException</span><span class="o">:</span> <span class="n">没有权限</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">SingleQueryHandler</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">SingleQueryHandler</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">50</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">TransactionImpl</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">TransactionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">213</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">ContractImpl</span><span class="o">.</span><span class="na">evaluateTransaction</span><span class="o">(</span><span class="n">ContractImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">55</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">clientCar</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="n">clientCar</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">43</span><span class="o">)</span>

<span class="n">Process</span> <span class="n">finished</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="n">1</span>
</code></pre></td></tr></table></div>
</div>
</div><p>所以，基于链码的访问控制就完成了</p>
<hr>
<p>最后一个小tips：</p>
<blockquote>
<p>我们可以使用openssl工具来查看我们的证书文件，在我们使用SDK进行注册用户之后，会在相关的文件夹中生成两个文件，其中一个是私钥文件，还有一个是json类型的一个文件(其中有用户的证书certification),将证书粘贴到新建的pem文件中，然后使用spenssl工具将两个用户的证书转换成文本形式</p>
<ul>
<li><code>songjian</code>用户的证书</li>
</ul>
<pre><code>-----BEGIN CERTIFICATE-----
MIICqTCCAk+gAwIBAgIUe7kl1iz7AC+JiI4V+GQSFMXh79gwCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTAwMzAwWhcNMjExMDE2MTAw
ODAwWjBFMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExETAPBgNVBAMTCHNvbmdqaWFuMFkwEwYHKoZIzj0CAQYIKoZIzj0D
AQcDQgAEwbOP5V6+LAQN7FLLeR0sNXIWmyG09TfE434e/7bbi/mJs4c1n6/8h3Ix
KCE3DOQwiH5EbHNuSa3j8XaFPIWE46OB7jCB6zAOBgNVHQ8BAf8EBAMCB4AwDAYD
VR0TAQH/BAIwADAdBgNVHQ4EFgQUixJa/Mionju24JKEGYwytn0rasIwKwYDVR0j
BCQwIoAgKIGbpvymakg5F6IFyeRvFQKplozygNldEr5VdR3Kc1QwfwYIKgMEBQYH
CAEEc3siYXR0cnMiOnsiaGYuQWZmaWxpYXRpb24iOiJvcmcxLmRlcGFydG1lbnQx
IiwiaGYuRW5yb2xsbWVudElEIjoic29uZ2ppYW4iLCJoZi5UeXBlIjoiY2xpZW50
IiwidXNlcnR5cGUiOiJ3b3JrZXIifX0wCgYIKoZIzj0EAwIDSAAwRQIhAKr6NRaL
aGC+NC8AWiVR6KqIbL3+A2y0tMPYP/NvsRFcAiAEB8nCmpRjYXTvekctqTtKtykL
utw3qJfW7wCFhnp8VQ==
-----END CERTIFICATE-----
</code></pre><p>在命令行执行：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in songjian.pem -noout -text
</code></pre></td></tr></table></div>
</div>
</div><p>输出如下：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            7b:b9:25:d6:2c:fb:00:2f:89:88:8e:15:f8:64:12:14:c5:e1:ef:d8
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = songjian
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c1:b3:8f:e5:5e:be:2c:04:0d:ec:52:cb:79:1d:
                    2c:35:72:16:9b:21:b4:f5:37:c4:e3:7e:1e:ff:b6:
                    db:8b:f9:89:b3:87:35:9f:af:fc:87:72:31:28:21:
                    37:0c:e4:30:88:7e:44:6c:73:6e:49:ad:e3:f1:76:
                    85:3c:85:84:e3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                8B:12:5A:FC:C8:A8:9E:3B:B6:E0:92:84:19:8C:32:B6:7D:2B:6A:C2
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;songjian&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;worker&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:aa:fa:35:16:8b:68:60:be:34:2f:00:5a:25:
         51:e8:aa:88:6c:bd:fe:03:6c:b4:b4:c3:d8:3f:f3:6f:b1:11:
         5c:02:20:04:07:c9:c2:9a:94:63:61:74:ef:7a:47:2d:a9:3b:
         4a:b7:29:0b:ba:dc:37:a8:97:d6:ef:00:85:86:7a:7c:55
</code></pre></td></tr></table></div>
</div>
</div><ul>
<li><code>yfhuang</code>的证书</li>
</ul>
<pre><code>-----BEGIN CERTIFICATE-----
MIICuDCCAl6gAwIBAgIULUajiYT7HTD8cJT7HHMKC9Vm7yswCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTAwMzAwWhcNMjExMDE2MTAw
ODAwWjBEMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExEDAOBgNVBAMTB3lmaHVhbmcwWTATBgcqhkjOPQIBBggqhkjOPQMB
BwNCAATrR6GhF0ZUBqvM2suH8GN1qVnFCCXq9gZV4iPkcTLufwKij0zVDdw1/uM7
RsPcEYtBGv4ofRW9UErmST58XynKo4H+MIH7MA4GA1UdDwEB/wQEAwIHgDAMBgNV
HRMBAf8EAjAAMB0GA1UdDgQWBBSglzSxtWdYHuCT/DWwmBaF1i+phjArBgNVHSME
JDAigCAogZum/KZqSDkXogXJ5G8VAqmWjPKA2V0SvlV1HcpzVDCBjgYIKgMEBQYH
CAEEgYF7ImF0dHJzIjp7ImhmLkFmZmlsaWF0aW9uIjoib3JnMS5kZXBhcnRtZW50
MSIsImhmLkVucm9sbG1lbnRJRCI6InlmaHVhbmciLCJoZi5UeXBlIjoiY2xpZW50
IiwidXNlcnR5cGUiOiJsZWFkZXJfY2FyX2RlcGFydG1lbnQifX0wCgYIKoZIzj0E
AwIDSAAwRQIhAKUSaUMnkbvZOaPCPnzW1FxVVJMJMRepFTgCQ9Eog80bAiBKoPHL
IJzGv2uVMmt47P+ydhm1Sw+nLHUJ1CjB7PKVgQ==
-----END CERTIFICATE-----
</code></pre><p>在命令行执行：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in yfhuang.pem -noout -text
</code></pre></td></tr></table></div>
</div>
</div><p>输出如下：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            2d:46:a3:89:84:fb:1d:30:fc:70:94:fb:1c:73:0a:0b:d5:66:ef:2b
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = yfhuang
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:eb:47:a1:a1:17:46:54:06🆎cc:da:cb:87:f0:
                    63:75:a9:59:c5:08:25:ea:f6:06:55:e2:23:e4:71:
                    32:ee:7f:02:a2:8f:4c:d5:0d:dc:35:fe:e3:3b:46:
                    c3:dc:11:8b:41:1a:fe:28:7d:15:bd:50:4a:e6:49:
                    3e:7c:5f:29:ca
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                A0:97:34:B1:B5:67:58:1E:E0:93:FC:35:B0:98:16:85:D6:2F:A9:86
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;yfhuang&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;leader_car_department&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:a5:12:69:43:27:91:bb:d9:39:a3:c2:3e:7c:
         d6:d4:5c:55:54:93:09:31:17:a9:15:38:02:43:d1:28:83💿
         1b:02:20:4a:a0:f1:cb:20:9c:c6:bf:6b:95:32:6b:78:ec:ff:
         b2:76:19:b5:4b:0f:a7:2c:75:09:d4:28:c1:ec:f2:95:81
PS C:\Users\Bun\Desktop&gt; openssl x509 -in songjian.pem -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            7b:b9:25:d6:2c:fb:00:2f:89:88:8e:15:f8:64:12:14:c5:e1:ef:d8
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = songjian
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c1:b3:8f:e5:5e:be:2c:04:0d:ec:52:cb:79:1d:
                    2c:35:72:16:9b:21:b4:f5:37:c4:e3:7e:1e:ff:b6:
                    db:8b:f9:89:b3:87:35:9f:af:fc:87:72:31:28:21:
                    37:0c:e4:30:88:7e:44:6c:73:6e:49:ad:e3:f1:76:
                    85:3c:85:84:e3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                8B:12:5A:FC:C8:A8:9E:3B:B6:E0:92:84:19:8C:32:B6:7D:2B:6A:C2
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;songjian&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;worker&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:aa:fa:35:16:8b:68:60:be:34:2f:00:5a:25:
         51:e8:aa:88:6c:bd:fe:03:6c:b4:b4:c3:d8:3f:f3:6f:b1:11:
         5c:02:20:04:07:c9:c2:9a:94:63:61:74:ef:7a:47:2d:a9:3b:
         4a:b7:29:0b:ba:dc:37:a8:97:d6:ef:00:85:86:7a:7c:55
PS C:\Users\Bun\Desktop&gt; openssl x509 -in yfhuang.pem -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            2d:46:a3:89:84:fb:1d:30:fc:70:94:fb:1c:73:0a:0b:d5:66:ef:2b
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = yfhuang
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:eb:47:a1:a1:17:46:54:06🆎cc:da:cb:87:f0:
                    63:75:a9:59:c5:08:25:ea:f6:06:55:e2:23:e4:71:
                    32:ee:7f:02:a2:8f:4c:d5:0d:dc:35:fe:e3:3b:46:
                    c3:dc:11:8b:41:1a:fe:28:7d:15:bd:50:4a:e6:49:
                    3e:7c:5f:29:ca
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                A0:97:34:B1:B5:67:58:1E:E0:93:FC:35:B0:98:16:85:D6:2F:A9:86
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;yfhuang&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;leader_car_department&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:a5:12:69:43:27:91:bb:d9:39:a3:c2:3e:7c:
         d6:d4:5c:55:54:93:09:31:17:a9:15:38:02:43:d1:28:83💿
         1b:02:20:4a:a0:f1:cb:20:9c:c6:bf:6b:95:32:6b:78:ec:ff:
         b2:76:19:b5:4b:0f:a7:2c:75:09:d4:28:c1:ec:f2:95:81
</code></pre></td></tr></table></div>
</div>
</div><p>可以观察到上面两个证书转换之后的文本中最后的attrs中的usertype是不一样的，也就是说明，我们的usertype已经enroll到证书中了，也就能在链码中读取了</p>
<p>我们再来看一个在注册用户的时候Enroll的时候没有指定将自定义的属性加入证书的例子(注意一个haha用户)</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;haha\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="c1">//register的时候设置用户自定义的属性类型
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;leader_car_department&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;haha\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table></div>
</div>
</div><p>下面是这个用户的证书：</p>
<pre><code>-----BEGIN CERTIFICATE-----
MIICjDCCAjOgAwIBAgIUJrH6/14VpN4DZAG/b3H7TwFxm0wwCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTEwMzAwWhcNMjExMDE2MTEw
ODAwWjBBMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExDTALBgNVBAMTBGhhaGEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNC
AATSOOKZ0tB7IRD97e+G8Rbka058hcLr+euj1WHNLipOOKeBvLFocCKMML2dL8hP
2mkndM1zj00YAkVP8yTwO97zo4HWMIHTMA4GA1UdDwEB/wQEAwIHgDAMBgNVHRMB
Af8EAjAAMB0GA1UdDgQWBBSuIp0UQPrfvmgbJ5iNhOZUh2e/1zArBgNVHSMEJDAi
gCAogZum/KZqSDkXogXJ5G8VAqmWjPKA2V0SvlV1HcpzVDBnBggqAwQFBgcIAQRb
eyJhdHRycyI6eyJoZi5BZmZpbGlhdGlvbiI6Im9yZzEuZGVwYXJ0bWVudDEiLCJo
Zi5FbnJvbGxtZW50SUQiOiJoYWhhIiwiaGYuVHlwZSI6ImNsaWVudCJ9fTAKBggq
hkjOPQQDAgNHADBEAiAYderD2wOsojvdK5k1zYyDLtK73KIYLS5dim02Oz3+BQIg
DjZ1y7kctNRyWJ3uXPJlZWISnwD3fpzp8QccIKE5bUY=
-----END CERTIFICATE-----
</code></pre><p>使用openssl工具，执行：</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in haha.pem -noout -text
</code></pre></td></tr></table></div>
</div>
</div><p>转换得到文本</p>
<pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            26:b1:fa:ff:5e:15:a4🇩🇪03:64:01:bf:6f:71:fb:4f:01:71:9b:4c
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 11:03:00 2020 GMT
            Not After : Oct 16 11:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = haha
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:d2:38:e2:99:d2:d0:7b:21:10:fd:ed:ef:86:f1:
                    16:e4:6b:4e:7c:85:c2:eb:f9:eb:a3:d5:61💿2e:
                    2a:4e:38:a7:81:bc:b1:68:70:22:8c:30:bd:9d:2f:
                    c8:4f:da:69:27:74:cd:73:8f:4d:18:02:45:4f:f3:
                    24:f0:3b🇩🇪f3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                AE:22:9D:14:40:FA:DF:BE:68:1B:27:98:8D:84:E6:54:87:67:BF:D7
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&quot;attrs&quot;:{&quot;hf.Affiliation&quot;:&quot;org1.department1&quot;,&quot;hf.EnrollmentID&quot;:&quot;haha&quot;,&quot;hf.Type&quot;:&quot;client&quot;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:44:02:20:18:75:ea:c3:db:03:ac:a2:3b:dd:2b:99:35💿
         8c:83:2e:d2:bb:dc:a2:18:2d:2e:5d:8a:6d:36:3b:3d:fe:05:
         02:20:0e:36:75:cb:b9:1c:b4:d4:72:58:9d:ee:5c:f2:65:65:
         62:12:9f:00:f7:7e:9c:e9:f1:07:1c:20:a1:39:6d:46
</code></pre><p>可以看到attrs中并没有加入usertype</p>
</blockquote>
<p>当然链码的控制还可以使用断言的方式进行</p>
<p>好了，大功告成！！！！</p>

            </div>

        </article>

        

        
    
    
        <ul class="post-copyright">
            <li class="copyright-item author"><span class="copyright-item-text">作者</span>：<a href="https://VegeBun-csj.github.io" target="_blank" rel="noopener">Bun</a></li>
            
                
                
                
                
                <li class="copyright-item link"><span class="copyright-item-text">链接</span>：<a href="/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/" target="_blank" rel="noopener">https://VegeBun-csj.github.io/posts/chaincode开发/cid链码访问控制库/</a></li>
            
            <li class="copyright-item license"><span class="copyright-item-text">许可</span>：<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></li>
            
        </ul>
    



        
    <div class="updated-badge-container">
        <span title="Updated @ 2020-10-16 19:30:45 CST" style="cursor:help">

<svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2020-10-16</text><text x="915" y="140" textLength="650" transform="scale(.1)">2020-10-16</text></g></svg>
        </span></div>



        


        <div class="post-share">

        

        <div class="share-items">

            
                <div class="share-item twitter">
                    
                    <a href="https://twitter.com/share?url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;text=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;hashtags=%e5%8c%ba%e5%9d%97%e9%93%be,golang,&amp;via=bun" title="分享到「Twitter」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </div>
            

            
                <div class="share-item facebook">
                    
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;hashtag=%23%e5%8c%ba%e5%9d%97%e9%93%be" title="分享到「Facebook」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon facebook-icon"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></a>
                </div>
            

            
                <div class="share-item linkedin">
                    
                    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;title=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;summary=Client%20Identity%20Chaincode%20Library%ef%bc%88%e5%ae%a2%e6%88%b7%e7%ab%af%e6%a0%87%e8%af%86%e9%93%be%e4%bb%a3%e7%a0%81%e5%ba%93%ef%bc%89%20The%20client%20identity%20chaincode%20library%20enables%20you%20to%20write%20chaincode%20which%20makes%20access%20control%20decisions%20based%20on%20the%20identity%20of%20the%e2%80%a6%e2%80%a6&amp;source=VegeBun-csj%e2%80%99s%20blog" title="分享到「LinkedIn」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </div>
            

            
                <div class="share-item telegram">
                    
                    <a href="https://t.me/share/url?url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;text=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29" title="分享到「Telegram」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon telegram-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a>
                </div>
            

            
                <div class="share-item weibo">
                    
                    <a href="https://service.weibo.com/share/share.php?&amp;url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;title=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;pic=https://VegeBun-csj.github.io/icons/apple-touch-icon.png&amp;searchPic=false" title="分享到「新浪微博」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon weibo-icon"><path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7 0 395.3 0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z"/></svg></a>
                </div>
            

            
                <div class="share-item douban">
                    
                    <a href="https://www.douban.com/share/service?href=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;name=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;text=Client%20Identity%20Chaincode%20Library%ef%bc%88%e5%ae%a2%e6%88%b7%e7%ab%af%e6%a0%87%e8%af%86%e9%93%be%e4%bb%a3%e7%a0%81%e5%ba%93%ef%bc%89%20The%20client%20identity%20chaincode%20library%20enables%20you%20to%20write%20chaincode%20which%20makes%20access%20control%20decisions%20based%20on%20the%20identity%20of%20the%e2%80%a6%e2%80%a6" title="分享到「豆瓣」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon douban-icon"><path d="M.643.92v2.412h22.714V.92H.643zm1.974 4.926v9.42h18.764v-9.42H2.617zm2.72 2.408H18.69v4.605H5.338V8.254zm1.657 7.412l-2.512.938c1.037 1.461 1.87 2.825 2.512 4.091H0v2.385h24v-2.385h-6.678c.818-1.176 1.589-2.543 2.303-4.091l-2.73-.938a29.952 29.952 0 01-2.479 5.03h-4.75c-.786-1.962-1.677-3.641-2.672-5.03Z"/></svg></a>
                </div>
            

            
                <div class="share-item qq">
                    
                    <a href="https://connect.qq.com/widget/shareqq/index.html?url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;title=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;summary=Client%20Identity%20Chaincode%20Library%ef%bc%88%e5%ae%a2%e6%88%b7%e7%ab%af%e6%a0%87%e8%af%86%e9%93%be%e4%bb%a3%e7%a0%81%e5%ba%93%ef%bc%89%20The%20client%20identity%20chaincode%20library%20enables%20you%20to%20write%20chaincode%20which%20makes%20access%20control%20decisions%20based%20on%20the%20identity%20of%20the%e2%80%a6%e2%80%a6&amp;pics=https://VegeBun-csj.github.io/icons/apple-touch-icon.png&amp;site=VegeBun-csj%e2%80%99s%20blog" title="分享到「QQ」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qq-icon"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a>
                </div>
            

            
                <div class="share-item qzone">
                    
                    <a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://VegeBun-csj.github.io/posts/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/&amp;title=%e9%93%be%e7%a0%81%e7%9a%84%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6%28cid%e5%ba%93%29&amp;summary=Client%20Identity%20Chaincode%20Library%ef%bc%88%e5%ae%a2%e6%88%b7%e7%ab%af%e6%a0%87%e8%af%86%e9%93%be%e4%bb%a3%e7%a0%81%e5%ba%93%ef%bc%89%20The%20client%20identity%20chaincode%20library%20enables%20you%20to%20write%20chaincode%20which%20makes%20access%20control%20decisions%20based%20on%20the%20identity%20of%20the%e2%80%a6%e2%80%a6&amp;pics=https://VegeBun-csj.github.io/icons/apple-touch-icon.png&amp;site=VegeBun-csj%e2%80%99s%20blog" title="分享到「QQ 空间」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon qzone-icon"><path d="M23.985 9.202c-.032-.099-.127-.223-.334-.258-.207-.036-7.351-1.406-7.351-1.406s-.105-.022-.198-.07c-.092-.047-.127-.167-.127-.167S12.447.956 12.349.77C12.25.583 12.104.532 12 .532c-.104 0-.251.051-.349.238-.098.186-3.626 6.531-3.626 6.531s-.035.12-.128.167c-.092.047-.197.07-.197.07S.556 8.908.348 8.943c-.208.036-.302.16-.333.258a.477.477 0 0 0 .125.449l5.362 5.49s.072.08.119.172c.016.104.005.21.005.21s-1.189 7.242-1.22 7.45.075.369.159.43c.083.062.233.106.421.013.189-.093 6.812-3.261 6.812-3.261s.098-.044.201-.061c.103-.017.201.061.201.061s6.623 3.168 6.812 3.261c.188.094.338.049.421-.013a.463.463 0 0 0 .159-.43c-.021-.14-.93-5.677-.93-5.677.876-.54 1.425-1.039 1.849-1.747-2.594.969-6.006 1.717-9.415 1.866-.915.041-2.41.097-3.473-.015-.678-.071-1.17-.144-1.243-.438-.053-.215.054-.46.545-.831a2640.5 2640.5 0 0 1 2.861-2.155c1.285-.968 3.559-2.47 3.559-2.731 0-.285-2.144-.781-4.037-.781-1.945 0-2.275.132-2.811.168-.488.034-.769.005-.804-.138-.06-.248.183-.389.588-.568.709-.314 1.86-.594 1.984-.626.194-.052 3.082-.805 5.618-.535 1.318.14 3.244.668 3.244 1.276 0 .342-1.721 1.494-3.225 2.597-1.149.843-2.217 1.561-2.217 1.688 0 .342 3.533 1.241 6.689 1.01l.003-.022c.048-.092.119-.172.119-.172l5.362-5.49a.477.477 0 0 0 .127-.449z"/></svg></a>
                </div>
            

            
                <div class="share-item qrcode">
                    <div class="qrcode-container" title="通过「二维码」"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id="qrcode-img"></div>
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>

<script>
    var typeNumber = 0;
    var errorCorrectionLevel = 'L';
    var qr = qrcode(typeNumber, errorCorrectionLevel);
    qr.addData('https:\/\/VegeBun-csj.github.io\/posts\/chaincode%E5%BC%80%E5%8F%91\/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93\/');
    qr.make();
    document.getElementById('qrcode-img').innerHTML = qr.createImgTag();
</script>

                </div>
            

        </div>

    </div>




        
    
    
        <div class="related-posts">
            <h2 class="related-title">相关文章：<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/></svg></h2>
            <ul class="related-list">
                
                    <li class="related-item">
                        <a href="/posts/chaincode%E5%BC%80%E5%8F%91/%E9%93%BE%E7%A0%81%E5%B8%B8%E8%A7%81%E7%9A%84api/" class="related-link">链码常见的API</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/fabricnodesdk/%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%9B%91%E5%90%AC%E4%BD%BF%E7%94%A8/" class="related-link">fabric事件的监听使用</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/fabric%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/fabric%E4%B8%AD%E7%9A%84%E8%B4%A6%E6%9C%AC%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" class="related-link">Fabric中的账本数据存储</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/fabric%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/fabric%E4%B8%AD%E7%9A%84%E8%AF%BB%E5%86%99%E9%9B%86/" class="related-link">Fabric中的读写集</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/chaincode%E5%BC%80%E5%8F%91/fabric%E5%90%AF%E7%94%A8couchdb%E4%BD%9C%E4%B8%BA%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/" class="related-link">Fabric启用CouchDB作为状态数据库</a>
                    </li>
                
            </ul>
        </div>
    



        
    
        <div class="post-tags">
            
                
                
                
                
                    
                    <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>区块链</a>
                
            
                
                
                
                
                    
                    <a href="/tags/golang/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>golang</a>
                
            
        </div>
    



        


        


        
    
        
        
    
    
    
    
        <ul class="post-nav">
            
                <li class="post-nav-prev">
                    <a href="/posts/fabricnodesdk/%E4%BA%A4%E6%98%93invoke%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="prev">&lt; 交易invoke的使用</a>
                </li>
            
            
                <li class="post-nav-next">
                    <a href="/posts/fabricnodesdk/ccp-connection-file%E7%9A%84%E8%AE%BE%E7%BD%AE/" rel="next">ccp文件的设置 &gt;</a>
                </li>
            
        </ul>
    



        
    

        <div class="load-comments">
            <div id="load-comments">加载评论</div>
        </div>

        

        

        

    



    </div>
</main>


            
    <div id="back-to-top" class="back-to-top">
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
    </div>


            
    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="site-info">©&nbsp;2018–2020&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;Bun</div><div class="powered-by">Powered by <a href="https://github.com/gohugoio/hugo" target="_blank" rel="noopener">Hugo</a> | Theme is <a href="https://github.com/reuixiy/hugo-theme-meme" target="_blank" rel="noopener">MemE</a></div><div class="site-copyright"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></div>
                <div class="busuanzi-site-uv-and-pv">
                    <span id="busuanzi_container_site_uv">本站访客数&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon busuanzi-site-uv"><path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"/></svg>&nbsp;<span id="busuanzi_value_site_uv"></span></span>&nbsp;|&nbsp;<span id="busuanzi_container_site_pv">本站访问量&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="icon busuanzi-site-pv"><path d="M288 144a110.94 110.94 0 0 0-31.24 5 55.4 55.4 0 0 1 7.24 27 56 56 0 0 1-56 56 55.4 55.4 0 0 1-27-7.24A111.71 111.71 0 1 0 288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400c-98.65 0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 400 288 400z"/></svg>&nbsp;<span id="busuanzi_value_site_pv"></span></span>
                </div>

            
    
        <ul class="socials"><li class="socials-item">
                    <a href="/rss.xml" target="_blank" rel="external noopener" title="RSS"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"/></svg></a>
                </li><li class="socials-item">
                    <a href="1071285741@qq.com" target="_blank" rel="external noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://github.com/VegeBun-csj" target="_blank" rel="external noopener" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://twitter.com/bun" target="_blank" rel="external noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://t.me/bun" target="_blank" rel="external noopener" title="Telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon social-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a>
                </li></ul>
    



            
        </div>
    </footer>


        </div>
        

        






    

        

        

        

    



    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js"></script>

<script>
    mediumZoom(document.querySelectorAll('div.post-body img'), {
        background: 'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'
    })
</script>




    <script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.min.js" type="module" defer></script>




    
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    




    </body>
</html>
