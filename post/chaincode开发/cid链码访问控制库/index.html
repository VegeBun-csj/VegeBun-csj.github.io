<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>é“¾ç çš„è®¿é—®æ§åˆ¶(cidåº“) - Even - A super concise theme for Hugo</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="VegeBun-csj" /><meta name="description" content="Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰ The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the client (i.e. the invoker of the chaincode). In particular, you may make access control decisions based on either or both of the following associated with the client: å®¢" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.74.3 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.edcb4e071bdc2fd679c1aeb628dad304879b36abfc9d07412c751d7fcba15996.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="é“¾ç çš„è®¿é—®æ§åˆ¶(cidåº“)" />
<meta property="og:description" content="Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰ The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the client (i.e. the invoker of the chaincode). In particular, you may make access control decisions based on either or both of the following associated with the client: å®¢" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/chaincode%E5%BC%80%E5%8F%91/cid%E9%93%BE%E7%A0%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%BA%93/" />
<meta property="article:published_time" content="2020-08-29T13:27:15+08:00" />
<meta property="article:modified_time" content="2020-08-29T13:27:15+08:00" />
<meta itemprop="name" content="é“¾ç çš„è®¿é—®æ§åˆ¶(cidåº“)">
<meta itemprop="description" content="Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰ The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the client (i.e. the invoker of the chaincode). In particular, you may make access control decisions based on either or both of the following associated with the client: å®¢">
<meta itemprop="datePublished" content="2020-08-29T13:27:15+08:00" />
<meta itemprop="dateModified" content="2020-08-29T13:27:15+08:00" />
<meta itemprop="wordCount" content="7163">



<meta itemprop="keywords" content="åŒºå—é“¾,golang," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="é“¾ç çš„è®¿é—®æ§åˆ¶(cidåº“)"/>
<meta name="twitter:description" content="Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰ The client identity chaincode library enables you to write chaincode which makes access control decisions based on the identity of the client (i.e. the invoker of the chaincode). In particular, you may make access control decisions based on either or both of the following associated with the client: å®¢"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">VegeBun-csj</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">VegeBun-csj</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">é“¾ç çš„è®¿é—®æ§åˆ¶(cidåº“)</h1>

      <div class="post-meta">
        <span class="post-time"> 29088-29 </span>
        <div class="post-category">
            <a href="/categories/hyperledger-fabric-chaincode%E5%BC%80%E5%8F%91/"> Hyperledger Fabric--chaincodeå¼€å‘ </a>
            </div>
          <span class="more-meta"> 7163 words </span>
          <span class="more-meta"> 15 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#client-identity-chaincode-libraryå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“">Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰</a>
      <ul>
        <li><a href="#using-the-client-identity-chaincode-libraryä½¿ç”¨æ–¹æ³•">Using the client identity chaincode libraryï¼ˆä½¿ç”¨æ–¹æ³•ï¼‰</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#adding-attributes-to-identitieså‘èº«ä»½æ·»åŠ å±æ€§">Adding Attributes to Identitiesï¼ˆå‘èº«ä»½æ·»åŠ å±æ€§ï¼‰</a>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="client-identity-chaincode-libraryå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“">Client Identity Chaincode Libraryï¼ˆå®¢æˆ·ç«¯æ ‡è¯†é“¾ä»£ç åº“ï¼‰</h1>
<p>The client identity chaincode library enables you to write chaincode which
makes access control decisions based on the identity of the client
(i.e. the invoker of the chaincode).  In particular, you may make access
control decisions based on either or both of the following associated with
the client:</p>
<p>å®¢æˆ·ç«¯æ ‡è¯†é“¾ç åº“ä½¿æ‚¨èƒ½å¤Ÿç¼–å†™åŸºäºå®¢æˆ·ç«¯æ ‡è¯†(å³é“¾ç çš„è°ƒç”¨è€…)è¿›è¡Œè®¿é—®æ§åˆ¶å†³ç­–çš„é“¾ç ã€‚
ç‰¹åˆ«æ˜¯ï¼Œæ‚¨å¯ä»¥æ ¹æ®ä¸å®¢æˆ·ç«¯å…³è”çš„ä¸‹åˆ—ä»»ä¸€é¡¹æˆ–ä¸¤é¡¹è¿›è¡Œè®¿é—®æ§åˆ¶å†³ç­–</p>
<ul>
<li>the client identity&rsquo;s MSP (Membership Service Provider) IDï¼ˆå®¢æˆ·ç«¯èº«ä»½çš„MSP(ä¼šå‘˜æœåŠ¡æä¾›è€…)IDï¼‰</li>
<li>an attribute associated with the client identityï¼ˆä¸å®¢æˆ·ç«¯èº«ä»½å…³è”çš„å±æ€§ï¼‰</li>
</ul>
<p>Attributes are simply name and value pairs associated with an identity.
For example, <code>email=me@gmail.com</code> indicates an identity has the <code>email</code>
attribute with a value of <code>me@gmail.com</code>.</p>
<p>å±æ€§åªæ˜¯ä¸èº«ä»½å…³è”çš„é”®å€¼å¯¹ã€‚ä¾‹å¦‚ï¼Œemail=me@gmail.comè¡¨ç¤ºä¸€ä¸ªæœ‰ç€emailå±æ€§ï¼Œå€¼ä¸ºme@gmail.comçš„èº«ä»½</p>
<h2 id="using-the-client-identity-chaincode-libraryä½¿ç”¨æ–¹æ³•">Using the client identity chaincode libraryï¼ˆä½¿ç”¨æ–¹æ³•ï¼‰</h2>
<p>This section describes how to use the client identity chaincode library.</p>
<p>All code samples below assume two things:</p>
<ol>
<li>
<p>The type of the <code>stub</code> variable is <code>ChaincodeStubInterface</code> as passed
to your chaincode. å°†stubä½œä¸º<code>ChaincodeStubInterface</code>æ¥å£ä¼ å…¥chaincode</p>
</li>
<li>
<p>You have added the following import statement to your chaincode.  å¯¼å…¥ç›¸å…³çš„åŒ…</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">import &#34;github.com/hyperledger/fabric/core/chaincode/lib/cid&#34;
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="getting-the-clients-idè·å–å®¢æˆ·ç«¯id">Getting the client&rsquo;s IDï¼ˆè·å–å®¢æˆ·ç«¯idï¼‰</h4>
<p>The following demonstrates how to get an ID for the client which is guaranteed
to be unique within the MSP:  ä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•ä¸ºå®¢æˆ·ç«¯è·å–ä¸€ä¸ªIDï¼Œå®ƒä¿è¯åœ¨MSPä¸­æ˜¯å”¯ä¸€çš„:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">id, err := cid.GetID(stub)
</code></pre></td></tr></table>
</div>
</div><h4 id="getting-the-msp-idè·å–mspid">Getting the MSP IDï¼ˆè·å–mspidï¼‰</h4>
<p>The following demonstrates how to get the MSP ID of the client&rsquo;s identity: ä¸‹é¢æ¼”ç¤ºå¦‚ä½•è·å–å®¢æˆ·ç«¯èº«ä»½çš„MSP ID:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">mspid, err := cid.GetMSPID(stub)
</code></pre></td></tr></table>
</div>
</div><h4 id="getting-an-attribute-valueè·å–å±æ€§å€¼">Getting an attribute valueï¼ˆè·å–å±æ€§å€¼ï¼‰</h4>
<p>The following demonstrates how to get the value of the <em>attr1</em> attribute:ä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•è·å–attr1å±æ€§çš„å€¼:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">val, ok, err := cid.GetAttributeValue(stub, &#34;attr1&#34;)
if err != nil {
   // There was an error trying to retrieve the attribute
}
if !ok {
   // The client identity does not possess the attribute
}
// Do something with the value of &#39;val&#39;
</code></pre></td></tr></table>
</div>
</div><h4 id="asserting-an-attribute-value-æ–­è¨€å±æ€§å€¼åˆ¤æ–­attrçš„keyæ˜¯å¦ä¸ºå¯¹åº”çš„value">Asserting an attribute value æ–­è¨€å±æ€§å€¼ï¼ˆåˆ¤æ–­Attrçš„keyæ˜¯å¦ä¸ºå¯¹åº”çš„valueï¼‰</h4>
<p>Often all you want to do is to make an access control decision based on the value
of an attribute, i.e. to assert the value of an attribute.  For example, the following
will return an error if the client does not have the <code>myapp.admin</code> attribute
with a value of <code>true</code>:p</p>
<p>é€šå¸¸ï¼Œæ‚¨æƒ³åšçš„å°±æ˜¯æ ¹æ®å±æ€§çš„å€¼åšå‡ºè®¿é—®æ§åˆ¶å†³ç­–ï¼Œå³æ–­è¨€å±æ€§çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯myapp.adminçš„å±æ€§å€¼ä¸ä¸ºtrueï¼Œä¸‹é¢çš„ä»£ç å°†è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">err := cid.AssertAttributeValue(stub, &#34;myapp.admin&#34;, &#34;true&#34;)
if err != nil {
   // Return an error
}
</code></pre></td></tr></table>
</div>
</div><p>This is effectively using attributes to implement role-based access control,
or RBAC for short.</p>
<p>è¿™æ˜¯æœ‰æ•ˆåœ°ä½¿ç”¨å±æ€§æ¥å®ç°åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œç®€ç§°RBACã€‚</p>
<h4 id="getting-the-clients-x509-certificate------------è·å–å®¢æˆ·ç«¯çš„x509è¯ä¹¦">Getting the client&rsquo;s X509 certificate            è·å–å®¢æˆ·ç«¯çš„X509è¯ä¹¦</h4>
<p>The following demonstrates how to get the X509 certificate of the client, or
nil if the client&rsquo;s identity was not based on an X509 certificate:</p>
<p>ä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•è·å¾—å®¢æˆ·ç«¯çš„X509è¯ä¹¦ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„èº«ä»½ä¸æ˜¯åŸºäºX509è¯ä¹¦ï¼Œåˆ™ä¸ºnil:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cert, err := cid.GetX509Certificate(stub)
</code></pre></td></tr></table>
</div>
</div><p>Note that both <code>cert</code> and <code>err</code> may be nil as will be the case if the identity
is not using an X509 certificate.</p>
<p>è¯·æ³¨æ„ï¼Œcertå’Œerréƒ½å¯èƒ½ä¸ºnilï¼Œå¦‚æœå®¢æˆ·ç«¯èº«ä»½æ²¡æœ‰ä½¿ç”¨X509è¯ä¹¦ï¼Œåˆ™å°†å‡ºç°è¿™ç§æƒ…å†µã€‚</p>
<h4 id="performing-multiple-operations-more-efficientlyæ›´æœ‰æ•ˆåœ°æ‰§è¡Œå¤šä¸ªæ“ä½œ">Performing multiple operations more efficientlyï¼ˆæ›´æœ‰æ•ˆåœ°æ‰§è¡Œå¤šä¸ªæ“ä½œï¼‰</h4>
<p>Sometimes you may need to perform multiple operations in order to make an access
decision.  For example, the following demonstrates how to grant access to
identities with MSP <em>org1MSP</em> and <em>attr1</em> OR with MSP <em>org1MSP</em> and <em>attr2</em>.</p>
<p>æœ‰æ—¶æ‚¨å¯èƒ½éœ€è¦æ‰§è¡Œå¤šä¸ªæ“ä½œæ‰èƒ½åšå‡ºè®¿é—®å†³ç­–ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨MSP org1MSPå’Œattr1æˆ–MSP org1MSPå’Œattr2æˆäºˆèº«ä»½çš„è®¿é—®æƒã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// Get the client ID object
id, err := cid.New(stub)
if err != nil {
   // Handle error
}
mspid, err := id.GetMSPID()
if err != nil {
   // Handle error
}
switch mspid {
   case &#34;org1MSP&#34;:
      err = id.AssertAttributeValue(&#34;attr1&#34;, &#34;true&#34;)
   case &#34;org2MSP&#34;:
      err = id.AssertAttributeValue(&#34;attr2&#34;, &#34;true&#34;)
   default:
      err = errors.New(&#34;Wrong MSP&#34;)
}
</code></pre></td></tr></table>
</div>
</div><p>Although it is not required, it is more efficient to make the <code>cid.New</code> call
to get the ClientIdentity object if you need to perform multiple operations,
as demonstrated above.</p>
<p>è™½ç„¶ä¸æ˜¯å¿…éœ€çš„ã€‚å¦‚æœéœ€è¦æ‰§è¡Œå¤šä¸ªæ“ä½œï¼Œç”¨<code>cid.New</code>è°ƒç”¨æ¥è·å–ClientIdentityå¯¹è±¡æ˜¯éå¸¸æœ‰æ•ˆçš„ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚</p>
<h2 id="adding-attributes-to-identitieså‘èº«ä»½æ·»åŠ å±æ€§">Adding Attributes to Identitiesï¼ˆå‘èº«ä»½æ·»åŠ å±æ€§ï¼‰</h2>
<p>This section describes how to add custom attributes to certificates when
using Hyperledger Fabric CA as well as when using an external CA.</p>
<p>æœ¬èŠ‚æè¿°å¦‚ä½•åœ¨ä½¿ç”¨Hyperledger Fabric CAæ—¶ä»¥åŠåœ¨ä½¿ç”¨å¤–éƒ¨CAæ—¶å‘è¯ä¹¦æ·»åŠ è‡ªå®šä¹‰å±æ€§ã€‚</p>
<h4 id="managing-attributes-with-fabric-caä½¿ç”¨fabric-caç®¡ç†å±æ€§">Managing attributes with Fabric CAï¼ˆä½¿ç”¨Fabric CAç®¡ç†å±æ€§ï¼‰</h4>
<p>There are two methods of adding attributes to an enrollment certificate
with fabric-ca:</p>
<p>ï¼ˆä½¿ç”¨fabric-caå‘æ³¨å†Œè¯ä¹¦æ·»åŠ å±æ€§æœ‰ä¸¤ç§æ–¹æ³•:ï¼‰</p>
<ol>
<li>
<p>When you register an identity, you can specify that an enrollment certificate
issued for the identity should by default contain an attribute.  This behavior
can be overridden at enrollment time, but this is useful for establishing
default behavior and, assuming registration occurs outside of your application,
does not require any application change.</p>
<p>å½“æ‚¨æ³¨å†Œä¸€ä¸ªèº«ä»½æ—¶ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸ºè¯¥èº«ä»½é¢å‘çš„ç™»è®°è¯ä¹¦ï¼ˆe-certï¼‰åœ¨ç¼ºçœæƒ…å†µä¸‹åº”è¯¥åŒ…å«ä¸€ä¸ªå±æ€§(attribute)ã€‚å¯ä»¥åœ¨æ³¨å†Œæ—¶è¦†ç›–æ­¤è¡Œä¸ºï¼Œä½†è¿™å¯¹äºå»ºç«‹é»˜è®¤è¡Œä¸ºéå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”å‡è®¾æ³¨å†Œå‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºä¹‹å¤–ï¼Œä¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œä»»ä½•æ›´æ”¹ã€‚</p>
<p>The following shows how to register <em>user1</em> with two attributes:
<em>app1Admin</em> and <em>email</em>.
The &ldquo;:ecert&rdquo; suffix causes the <em>appAdmin</em> attribute to be inserted into user1&rsquo;s
enrollment certificate by default.  The <em>email</em> attribute is not added
to the enrollment certificate by default.</p>
<p>ä¸‹é¢å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªå±æ€§ app1Adminå’Œemailæ³¨å†Œuser1ã€‚â€œ:ecertâ€åç¼€åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šå°†appAdminå±æ€§æ’å…¥user1çš„ç™»è®°è¯ä¹¦ï¼ˆe-certï¼‰ä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªå°†emailå±æ€§æ·»åŠ åˆ°ç™»è®°è¯ä¹¦(e-cert)ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">fabric-ca-client register --id.name user1 --id.secret user1pw --id.type user --id.affiliation org1 --id.attrs &#39;app1Admin=true:ecert,email=user1@gmail.com&#39;
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>When you enroll an identity, you may request that one or more attributes
be added to the certificate.
For each attribute requested, you may specify whether the attribute is
optional or not.  If it is not optional but does not exist for the identity,
enrollment fails.</p>
<p>å½“æ‚¨ç™»è®°ä¸€ä¸ªèº«ä»½æ—¶ï¼Œæ‚¨å¯ä»¥è¯·æ±‚å°†ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§æ·»åŠ åˆ°è¯ä¹¦ä¸­ã€‚å¯¹äºè¯·æ±‚çš„æ¯ä¸ªå±æ€§ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¯¥å±æ€§æ˜¯å¦æ˜¯å¯é€‰çš„ã€‚å¦‚æœè¯¥èº«ä»½çš„å±æ€§æ˜¯å¿…é€‰çš„ï¼Œä½†ä¸å­˜åœ¨ï¼Œåˆ™ç™»è®°å¤±è´¥ã€‚</p>
<p>The following shows how to enroll <em>user1</em> with the <em>email</em> attribute,
without the <em>app1Admin</em> attribute and optionally with the <em>phone</em> attribute
(if the user possesses <em>phone</em> attribute).</p>
<p>ä¸‹é¢å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨emailå±æ€§æ³¨å†Œuser1ï¼Œä¸ä½¿ç”¨app1Adminå±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨phoneå±æ€§(å¦‚æœç”¨æˆ·æ‹¥æœ‰phoneå±æ€§)ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">fabric-ca-client enroll -u http://user1:user1pw@localhost:7054 --enrollment.attrs &#34;email,phone:opt&#34;
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="attribute-format-in-a-certificate-è¯ä¹¦ä¸­çš„å±æ€§æ ¼å¼">Attribute format in a certificate ï¼ˆè¯ä¹¦ä¸­çš„å±æ€§æ ¼å¼ï¼‰</h4>
<p>Attributes are stored inside an X509 certificate as an extension with an
ASN.1 OID (Abstract Syntax Notation Object IDentifier)
of <code>1.2.3.4.5.6.7.8.1</code>.  The value of the extension is a JSON string of the
form <code>{&quot;attrs&quot;:{&lt;attrName&gt;:&lt;attrValue}}</code>.  The following is a sample of a
certificate which contains the <code>attr1</code> attribute with a value of <code>val1</code>.
See the final entry in the <em>X509v3 extensions</em> section.  Note also that the JSON
entry could contain multiple attributes, though this sample shows only one.</p>
<p>å±æ€§ä½œä¸ºæ‰©å±•åå­˜å‚¨åœ¨X509è¯ä¹¦ä¸­ï¼Œå…¶ASN.1 OID(æŠ½è±¡è¯­æ³•ç¬¦å·å¯¹è±¡æ ‡è¯†ç¬¦)ä¸º1.2.3.4.5.6.7.8.1ã€‚è¯¥æ‰©å±•çš„å€¼æ˜¯ä»¥{&ldquo;attrs&rdquo;:{<attrName>:&lt;attrValue}}ï¼ˆå±æ€§åï¼Œå±æ€§å€¼è¿™ç§é”®å€¼å¯¹ï¼‰ä¸ºå½¢å¼çš„JSONå­—ç¬¦ä¸²ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè¯ä¹¦ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«å€¼ä¸ºval1çš„attr1å±æ€§ã€‚è¯·å‚é˜…X509v3æ‰©å±•éƒ¨åˆ†ä¸­çš„æœ€åä¸€é¡¹ã€‚è¿˜è¦æ³¨æ„ï¼ŒJSONæ¡ç›®å¯ä»¥åŒ…å«å¤šä¸ªå±æ€§ï¼Œä½†æœ¬ç¤ºä¾‹åªæ˜¾ç¤ºäº†ä¸€ä¸ªå±æ€§ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            1e:49:98:e9:f4:4f:d0:03:53:bf:36:81:c0:a0:a4:31:96:4f:52:75
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: CN=fabric-ca-server
        Validity
            Not Before: Sep  8 03:42:00 2017 GMT
            Not After : Sep  8 03:42:00 2018 GMT
        Subject: CN=MyTestUserWithAttrs
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
            EC Public Key:
                pub:
                    04:e6:07:5a:f7:09:d5:af:38:e3:f7:a2:90:77:0e:
                    32:67:5b:70:a7:37:ca:b5:c9:d8:91:77:39:ae:03:
                    a0:36:ad:72:b3:3c:89:6d:1e:f6:1b:6d:2a:88:49:
                    92:6e:6e:cc:bc:81:52:fa:19:88:18:5c:d7:6e:eb:
                    d4:73:cc:51:79
                ASN1 OID: prime256v1
        X509v3 extensions:
            X509v3 Key Usage: critical
                Certificate Sign
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                D8:28:B4:C0:BC:92:4A:D3:C3:8C:54:6C:08:86:33:10:A6:8D:83:AE
            X509v3 Authority Key Identifier:
                keyid:C4:B3:FE:76:0D:E2:DE:3C:FC:75:FB:AE:55:86:04:F0:BB:7F:F6:01

            X509v3 Subject Alternative Name:
                DNS:Anils-MacBook-Pro.local
            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;attr1&#34;:&#34;val1&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
        30:45:02:21:00:fb:84:a9:65:29:b2:f4:d3:bc:1a:8b:47:92:
        5e:41:27:2d:26:ec:f7ğŸ’¿aa:86:46:a4:ac:da:25:be:40:1d:
        c5:02:20:08:3f:49:86:58:a7:20:48:64:4c:30:1b:da:a9:a2:
        f2:b4:16:28:f6:fd:e1:46:dd:6b:f2:3f:2f:37:4a:4c:72
</code></pre></td></tr></table>
</div>
</div><p>If you want to use the client identity library to extract or assert attribute
values as described previously but you are not using Hyperledger Fabric CA,
then you must ensure that the certificates which are issued by your external CA
contain attributes of the form shown above.  In particular, the certificates
must contain the <code>1.2.3.4.5.6.7.8.1</code> X509v3 extension with a JSON value
containing the attribute names and values for the identity.</p>
<p>å¦‚æœæ‚¨æƒ³ä½¿ç”¨å‰é¢æè¿°çš„å®¢æˆ·ç«¯èº«ä»½åº“æ¥æå–æˆ–æ–­è¨€å±æ€§å€¼ï¼Œä½†æ˜¯æ‚¨æ²¡æœ‰ä½¿ç”¨Hyperledger Fabric CAï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»ç¡®ä¿ç”±æ‚¨çš„å¤–éƒ¨CAé¢å‘çš„è¯ä¹¦åŒ…å«ä¸Šé¢æ‰€ç¤ºè¡¨å•çš„å±æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¯ä¹¦å¿…é¡»åŒ…å«1.2.3.4.5.6.7.8.1 X509v3æ‰©å±•ï¼Œå…¶JSONå€¼åŒ…å«æ ‡è¯†çš„å±æ€§åå’Œå€¼ã€‚</p>
<hr>
<p>ä¸‹é¢åˆ—ä¸¾ä¸€ä¸ªå®é™…ä½¿ç”¨çš„ä¾‹å­ï¼š<strong>(æ³¨æ„åœ¨åˆçº¦ä¸­å¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼Œå³cidåº“æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥å€Ÿé‰´fabric-samples/chaincode/abacä¸­çš„åº“çš„å¼•ç”¨)</strong></p>
<p>æ­¤é“¾ç åº“cidæ˜¯ç”¨æ¥è¿›è¡Œé“¾ç æ“ä½œæƒé™çš„æ§åˆ¶çš„ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªattrsçš„name-valueè¯¥å¦‚ä½•è·å–å‘¢ï¼Œä»ä¸Šé¢çš„è§£é‡Šä¸­å¯ä»¥çœ‹åˆ°è·ŸCAæœ‰å…³ï¼Œæ‰€ä»¥æ˜¯åœ¨æˆ‘ä»¬æ³¨å†Œç”¨æˆ·èº«ä»½çš„æ—¶å€™è¿›è¡Œè®¾ç½®çš„ï¼Œä¸‹é¢åˆ—ä¸¾ä½¿ç”¨Node sdkè¿›è¡Œåˆå§‹åŒ–è®¾ç½®attrsçš„ä¾‹å­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"> <span class="kr">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span>
     <span class="p">{</span>
       <span class="nx">affiliation</span><span class="o">:</span> <span class="s1">&#39;org1.department1&#39;</span><span class="p">,</span>
       <span class="nx">enrollmentID</span><span class="o">:</span> <span class="s1">&#39;cai&#39;</span><span class="p">,</span>
       <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;client&#39;</span><span class="p">,</span>
       <span class="nx">attrs</span><span class="o">:</span> <span class="p">[</span>					<span class="c1">//åœ¨registerçš„ä¼ å…¥å±æ€§ä¸­æœ‰attrsè¿™ä¸ªå‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªArrayæ•°ç»„
</span><span class="c1"></span>       <span class="p">{</span>						<span class="c1">//å…¶ä¸­ä¼ å…¥ä¸‰ä¸ª
</span><span class="c1"></span>         <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;usertype&#39;</span><span class="p">,</span>		<span class="c1">//attrsçš„nameï¼Œä¹Ÿå°±æ˜¯key
</span><span class="c1"></span>         <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;storeshop&#39;</span><span class="p">,</span>	<span class="c1">//attrsçš„valueï¼Œä¹Ÿå°±æ˜¯keyå¯¹åº”çš„å€¼
</span><span class="c1"></span>         <span class="nx">ecert</span><span class="o">:</span> <span class="kc">true</span>			<span class="c1">//ecertä¸ºtrueè¡¨ç¤ºé»˜è®¤æƒ…å†µä¸‹åº”å°†æ­¤å±æ€§åŒ…æ‹¬åœ¨æ³¨å†Œè¯ä¹¦ä¸­(é»˜è®¤)
</span><span class="c1"></span>      <span class="p">}]</span>
     <span class="p">},</span>
    <span class="nx">adminIdentity</span>
   <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢å°±æ˜¯è®¾ç½®äº†attrsçš„nameæ˜¯usertype,valueæ˜¯storeshop</p>
<p>é“¾ç æˆ‘ä»¬æ˜¯ä»¥å®˜æ–¹çš„fabcaré“¾ç è¿›è¡Œäº†å°å°çš„ä¿®æ”¹ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>
<blockquote>
<p><a href="https://github.com/VegeBun-csj/learning-chaincode/blob/master/access-control/go/fabcar.go">https://github.com/VegeBun-csj/learning-chaincode/blob/master/access-control/go/fabcar.go</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">//æ ¹æ®nameè·å–ç”¨æˆ·çš„attrçš„å€¼
</span><span class="c1">//è¿™é‡Œå°±æ˜¯æ ¹æ®name--usertypeæ¥è·å–æˆ‘ä»¬æ³¨å†Œæ—¶è®¾ç½®çš„valueï¼Œå¦‚æœä½¿ç”¨ä¸Šé¢æ³¨å†Œæ—¶çš„èº«ä»½userè¿›è¡Œè°ƒç”¨å°±ä¼šè·å–åˆ°usertypeå¯¹åº”çš„valueæ˜¯storeshop
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="nf">getAttr</span><span class="p">(</span><span class="nx">APIstub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">sc</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">,</span> <span class="nx">found</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">cid</span><span class="p">.</span><span class="nf">GetAttributeValue</span><span class="p">(</span><span class="nx">APIstub</span><span class="p">,</span> <span class="s">&#34;usertype&#34;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">found</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
  	 <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;æœªæŸ¥è¯¢åˆ°å±æ€§å€¼&#34;</span><span class="p">)</span>
  <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">{</span>
  	 <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;æŸ¥è¯¢é”™è¯¯&#34;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">res</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">//ç±»å‹æ–­è¨€ -----ç”¨æ¥åˆ¤æ–­æ˜¯å¦å½“å‰çš„æ“ä½œç”¨æˆ·çš„attrçš„keyä¸valueæ˜¯å¦ä¸è¿™é‡ŒæŒ‡å®šçš„å€¼åŒ¹é…
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="nf">AssertAttr</span><span class="p">(</span><span class="nx">APIstub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">sc</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="nx">err</span> <span class="o">:=</span> <span class="nx">cid</span><span class="p">.</span><span class="nf">AssertAttributeValue</span><span class="p">(</span><span class="nx">APIstub</span><span class="p">,</span> <span class="s">&#34;usertype&#34;</span><span class="p">,</span> <span class="s">&#34;storeshop&#34;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">&#34;ç±»å‹ä¸æ˜¯storeshop&#34;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nf">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;ç±»å‹æ˜¯storeshop&#34;</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¼”ç¤ºä¸€ä¸ªåœ¨Java-SDKä¸­é€šè¿‡<code>CID</code>åº“è¿›è¡Œé“¾ç è®¿é—®æ§åˆ¶çš„ä¾‹å­ï¼š</p>
<p>é“¾ç åœ°å€å¦‚ä¸‹ï¼š</p>
<p>fabric-SDK-Javaçš„å®¢æˆ·ç«¯ä»£ç ä¸º:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;songjian\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="c1">// Register the user, enroll the user, and import the new identity into the wallet.
</span><span class="c1"></span>        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">);</span>

        <span class="c1">//registerçš„æ—¶å€™è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ç±»å‹
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;worker&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>
        <span class="c1">//enrollçš„æ—¶å€™ï¼ŒæŒ‡å®šä¹‹å‰registerçš„ç”¨æˆ·ä¸­çš„å“ªäº›å±æ€§è¦åŠ å…¥åˆ°è¯ä¹¦ä¸­ï¼Œå¦‚æœä¸åŠ ï¼Œåä¹°ä½ åœ¨é“¾ç ä¸­å°±è¯»å–ä¸åˆ°
</span><span class="c1"></span>        <span class="n">EnrollmentRequest</span> <span class="n">enrollmentRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnrollmentRequest</span><span class="o">();</span>
        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Affiliation&#34;</span><span class="o">);</span>		<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.EnrollmentID&#34;</span><span class="o">);</span>	<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Type&#34;</span><span class="o">);</span>			<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">);</span>			<span class="c1">//user-defined attribute
</span><span class="c1"></span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">,</span><span class="n">enrollmentRequest</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;songjian&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;songjian\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼šåœ¨registerä¸­è‡ªå®šä¹‰äº†å±æ€§å€¼ä¹‹åï¼Œéœ€è¦åœ¨æœ€åè¿›è¡ŒEnrollçš„æ—¶å€™ï¼Œå°†ç›¸å…³çš„å±æ€§æ”¾å…¥<code>EnrollmentRequest</code>ä¸­ï¼Œå¦åˆ™å°±ä¼šå‡ºç°åœ¨é“¾ç ä¸­è·å–ä¸åˆ°attributionçš„å±æ€§å€¼ï¼Œæˆ‘è¿™è¾¹å°±æ˜¯Enrollçš„æ—¶å€™æ²¡åŠ ï¼Œå¯¼è‡´æˆ‘ä¸€åº¦æ€€ç–‘è‡ªå·±çš„é“¾ç å‡ºç°äº†é—®é¢˜ï¼Œæœ€åçœ‹åˆ°ç½‘ä¸Šå¤§ä½¬çš„æ‰å‘ç°æ˜¯è¿™æ­¥ä¸å¯¹ï¼Œä¹‹å‰ä½¿ç”¨NodeSDKçš„æ—¶å€™å¥½åƒæ²¡è¿™ä¸ªé—®é¢˜ï¼Œä¼°è®¡æ˜¯SDKä¸åŒpaã€‚ã€‚ã€‚ã€‚ä¹Ÿç®—æ˜¯å­¦åˆ°äº†hh</p>
</blockquote>
<p>è¿™ä¸ªä¾‹å­æƒ³å®ç°çš„å°±æ˜¯ï¼Œfabcarä¸­çš„æ±½è½¦ï¼Œåªæœ‰ç”¨æˆ·å±æ€§ä¸º<code>leader_car_department(æ±½è½¦éƒ¨é—¨ä¸»ç®¡)</code>ç±»å‹çš„æ‰å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„æ±½è½¦å¹¶ä¸”æ›´æ”¹æ±½è½¦çš„æ‰€æœ‰è€…,å…¶ä»–å±æ€§å€¼çš„æ˜¯çœ‹ä¸äº†çš„ï¼Œæ¯”å¦‚æ™®é€šçš„å·¥äºº<code>worker</code></p>
<p>ç”¨æˆ·å±æ€§<code>Attr</code>æˆ‘ä»¬å®šä¹‰ä¸º<code>usertype</code>ï¼Œä½†æ˜¯<code>value</code>çš„å€¼å°±å¯ä»¥æœ‰å¾ˆå¤šäº†ï¼Œæ¯”å¦‚worker(å‘˜å·¥)&hellip;..è¿˜æœ‰å…¶ä»–çš„ã€‚ã€‚ã€‚</p>
<p>ä¸Šé¢æ˜¯æ³¨å†Œäº†ä¸€ä¸ª<code>Attr</code>ä¸º<code>usertype</code>ï¼Œ<code>value</code>ä¸º<code>worker</code>çš„ç”¨æˆ·<code>songjian</code>ï¼Œæ‰€ä»¥è¿™ä¸ªç”¨æˆ·æ˜¯ä¸èƒ½è°ƒç”¨<code>queryAllCars</code>å’Œ<code>changeCarOwner</code>çš„</p>
<p>ä¸‹é¢æˆ‘ä»¬å†æ³¨å†Œä¸€ä¸ªç”¨æˆ·<code>yfhuang</code>ï¼Œä»–çš„ç±»å‹ä¸º<code>leader_car_department(æ±½è½¦éƒ¨é—¨ä¸»ç®¡)</code>,æ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨<code>queryAllCars</code>å’Œ<code>changeCarOwner</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;yfhuang\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="c1">// Register the user, enroll the user, and import the new identity into the wallet.
</span><span class="c1"></span>        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">);</span>

        <span class="c1">//registerçš„æ—¶å€™è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ç±»å‹
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;leader_car_department&#34;</span><span class="o">));</span>

        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>

        <span class="c1">//enrollçš„æ—¶å€™ï¼ŒæŒ‡å®šä¹‹å‰registerçš„ç”¨æˆ·ä¸­çš„å“ªäº›å±æ€§è¦åŠ å…¥åˆ°è¯ä¹¦ä¸­ï¼Œå¦‚æœä¸åŠ ï¼Œåä¹°ä½ åœ¨é“¾ç ä¸­å°±è¯»å–ä¸åˆ°
</span><span class="c1"></span>        <span class="n">EnrollmentRequest</span> <span class="n">enrollmentRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnrollmentRequest</span><span class="o">();</span>
        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Affiliation&#34;</span><span class="o">);</span>		<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.EnrollmentID&#34;</span><span class="o">);</span>	<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;hf.Type&#34;</span><span class="o">);</span>			<span class="c1">//default attribute
</span><span class="c1"></span>        <span class="n">enrollmentRequest</span><span class="o">.</span><span class="na">addAttrReq</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">);</span>				<span class="c1">//user-defined attribute
</span><span class="c1"></span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">,</span><span class="n">enrollmentRequest</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;yfhuang&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;yfhuang\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>ä»¥<code>yfhuang</code>ç”¨æˆ·è¿›è¡Œè°ƒç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Contract</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Gateway</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Network</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @author csj
</span><span class="cm"> * @date 2020/10/16 - 16:49
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">clientCar</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;false&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Load a file system based wallet for managing identities.
</span><span class="c1"></span>        <span class="n">Path</span> <span class="n">walletPath</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">);</span>
        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">walletPath</span><span class="o">);</span>

        <span class="c1">// load a CCP
</span><span class="c1"></span>        <span class="n">Path</span> <span class="n">networkConfigPath</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/connection-org1.yaml&#34;</span><span class="o">);</span>

        <span class="n">Gateway</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">Gateway</span><span class="o">.</span><span class="na">createBuilder</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">identity</span><span class="o">(</span><span class="n">wallet</span><span class="o">,</span> <span class="s">&#34;yfhuang&#34;</span><span class="o">).</span><span class="na">networkConfig</span><span class="o">(</span><span class="n">networkConfigPath</span><span class="o">).</span><span class="na">discovery</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

        <span class="c1">// create a gateway connection
</span><span class="c1"></span>        <span class="k">try</span> <span class="o">(</span><span class="n">Gateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">connect</span><span class="o">())</span> <span class="o">{</span>

            <span class="c1">// get the network and contract
</span><span class="c1"></span>            <span class="n">Network</span> <span class="n">network</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getNetwork</span><span class="o">(</span><span class="s">&#34;mychannel&#34;</span><span class="o">);</span>
            <span class="n">Contract</span> <span class="n">contract</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="na">getContract</span><span class="o">(</span><span class="s">&#34;fabcar&#34;</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span><span class="o">;</span>
           <span class="c1">//è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯ç”¨æˆ·æ³¨å†Œå±æ€§ä¸ºleader_car_departmentï¼Œå°±ä¼šæŠ›å‡ºæ²¡æœ‰æƒé™çš„é”™è¯¯
</span><span class="c1"></span>            <span class="n">result</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="na">evaluateTransaction</span><span class="o">(</span><span class="s">&#34;queryAllCars&#34;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">result</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å¯ä»¥æŸ¥çœ‹åˆ°æ‰€æœ‰çš„æ±½è½¦çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="o">[{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR0&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;blue&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Toyota&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Prius&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Tomoko&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR1&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;red&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Ford&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Mustang&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Brad&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR2&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;green&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Hyundai&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Tucson&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Jin Soo&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR3&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;yellow&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Volkswagen&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Passat&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Max&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR4&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;black&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Tesla&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;S&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Adriana&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR5&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;purple&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Peugeot&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;205&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Michel&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR6&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;white&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Chery&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;S22L&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Aarav&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR7&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;violet&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Fiat&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Punto&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Pari&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR8&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;indigo&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Tata&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Nano&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Valeria&#34;</span><span class="o">}},{</span><span class="s">&#34;Key&#34;</span><span class="o">:</span><span class="s">&#34;CAR9&#34;</span><span class="o">,</span> <span class="s">&#34;Record&#34;</span><span class="o">:{</span><span class="s">&#34;colour&#34;</span><span class="o">:</span><span class="s">&#34;brown&#34;</span><span class="o">,</span><span class="s">&#34;make&#34;</span><span class="o">:</span><span class="s">&#34;Holden&#34;</span><span class="o">,</span><span class="s">&#34;model&#34;</span><span class="o">:</span><span class="s">&#34;Barina&#34;</span><span class="o">,</span><span class="s">&#34;owner&#34;</span><span class="o">:</span><span class="s">&#34;Shotaro&#34;</span><span class="o">}}]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»¥<code>songjian</code>ç”¨æˆ·è¿›è¡Œè°ƒç”¨ï¼š</p>
<p>å¯ä»¥çœ‹åˆ°çˆ†å‡ºäº†æƒé™é”™è¯¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">&#34;main&#34;</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">ContractException</span><span class="o">:</span> <span class="n">æ²¡æœ‰æƒé™</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">SingleQueryHandler</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">SingleQueryHandler</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">50</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">TransactionImpl</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">TransactionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">213</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">gateway</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">ContractImpl</span><span class="o">.</span><span class="na">evaluateTransaction</span><span class="o">(</span><span class="n">ContractImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">55</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">clientCar</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="n">clientCar</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">43</span><span class="o">)</span>

<span class="n">Process</span> <span class="n">finished</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="n">1</span>
</code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥ï¼ŒåŸºäºé“¾ç çš„è®¿é—®æ§åˆ¶å°±å®Œæˆäº†</p>
<hr>
<p>æœ€åä¸€ä¸ªå°tipsï¼š</p>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨opensslå·¥å…·æ¥æŸ¥çœ‹æˆ‘ä»¬çš„è¯ä¹¦æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨SDKè¿›è¡Œæ³¨å†Œç”¨æˆ·ä¹‹åï¼Œä¼šåœ¨ç›¸å…³çš„æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ç§é’¥æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯jsonç±»å‹çš„ä¸€ä¸ªæ–‡ä»¶(å…¶ä¸­æœ‰ç”¨æˆ·çš„è¯ä¹¦certification),å°†è¯ä¹¦ç²˜è´´åˆ°æ–°å»ºçš„pemæ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨spensslå·¥å…·å°†ä¸¤ä¸ªç”¨æˆ·çš„è¯ä¹¦è½¬æ¢æˆæ–‡æœ¬å½¢å¼</p>
<ul>
<li><code>songjian</code>ç”¨æˆ·çš„è¯ä¹¦</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">-----BEGIN CERTIFICATE-----
MIICqTCCAk+gAwIBAgIUe7kl1iz7AC+JiI4V+GQSFMXh79gwCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTAwMzAwWhcNMjExMDE2MTAw
ODAwWjBFMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExETAPBgNVBAMTCHNvbmdqaWFuMFkwEwYHKoZIzj0CAQYIKoZIzj0D
AQcDQgAEwbOP5V6+LAQN7FLLeR0sNXIWmyG09TfE434e/7bbi/mJs4c1n6/8h3Ix
KCE3DOQwiH5EbHNuSa3j8XaFPIWE46OB7jCB6zAOBgNVHQ8BAf8EBAMCB4AwDAYD
VR0TAQH/BAIwADAdBgNVHQ4EFgQUixJa/Mionju24JKEGYwytn0rasIwKwYDVR0j
BCQwIoAgKIGbpvymakg5F6IFyeRvFQKplozygNldEr5VdR3Kc1QwfwYIKgMEBQYH
CAEEc3siYXR0cnMiOnsiaGYuQWZmaWxpYXRpb24iOiJvcmcxLmRlcGFydG1lbnQx
IiwiaGYuRW5yb2xsbWVudElEIjoic29uZ2ppYW4iLCJoZi5UeXBlIjoiY2xpZW50
IiwidXNlcnR5cGUiOiJ3b3JrZXIifX0wCgYIKoZIzj0EAwIDSAAwRQIhAKr6NRaL
aGC+NC8AWiVR6KqIbL3+A2y0tMPYP/NvsRFcAiAEB8nCmpRjYXTvekctqTtKtykL
utw3qJfW7wCFhnp8VQ==
-----END CERTIFICATE-----
</code></pre></td></tr></table>
</div>
</div><p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in songjian.pem -noout -text
</code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            7b:b9:25:d6:2c:fb:00:2f:89:88:8e:15:f8:64:12:14:c5:e1:ef:d8
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = songjian
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c1:b3:8f:e5:5e:be:2c:04:0d:ec:52:cb:79:1d:
                    2c:35:72:16:9b:21:b4:f5:37:c4:e3:7e:1e:ff:b6:
                    db:8b:f9:89:b3:87:35:9f:af:fc:87:72:31:28:21:
                    37:0c:e4:30:88:7e:44:6c:73:6e:49:ad:e3:f1:76:
                    85:3c:85:84:e3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                8B:12:5A:FC:C8:A8:9E:3B:B6:E0:92:84:19:8C:32:B6:7D:2B:6A:C2
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;songjian&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;worker&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:aa:fa:35:16:8b:68:60:be:34:2f:00:5a:25:
         51:e8:aa:88:6c:bd:fe:03:6c:b4:b4:c3:d8:3f:f3:6f:b1:11:
         5c:02:20:04:07:c9:c2:9a:94:63:61:74:ef:7a:47:2d:a9:3b:
         4a:b7:29:0b:ba:dc:37:a8:97:d6:ef:00:85:86:7a:7c:55
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>yfhuang</code>çš„è¯ä¹¦</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">-----BEGIN CERTIFICATE-----
MIICuDCCAl6gAwIBAgIULUajiYT7HTD8cJT7HHMKC9Vm7yswCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTAwMzAwWhcNMjExMDE2MTAw
ODAwWjBEMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExEDAOBgNVBAMTB3lmaHVhbmcwWTATBgcqhkjOPQIBBggqhkjOPQMB
BwNCAATrR6GhF0ZUBqvM2suH8GN1qVnFCCXq9gZV4iPkcTLufwKij0zVDdw1/uM7
RsPcEYtBGv4ofRW9UErmST58XynKo4H+MIH7MA4GA1UdDwEB/wQEAwIHgDAMBgNV
HRMBAf8EAjAAMB0GA1UdDgQWBBSglzSxtWdYHuCT/DWwmBaF1i+phjArBgNVHSME
JDAigCAogZum/KZqSDkXogXJ5G8VAqmWjPKA2V0SvlV1HcpzVDCBjgYIKgMEBQYH
CAEEgYF7ImF0dHJzIjp7ImhmLkFmZmlsaWF0aW9uIjoib3JnMS5kZXBhcnRtZW50
MSIsImhmLkVucm9sbG1lbnRJRCI6InlmaHVhbmciLCJoZi5UeXBlIjoiY2xpZW50
IiwidXNlcnR5cGUiOiJsZWFkZXJfY2FyX2RlcGFydG1lbnQifX0wCgYIKoZIzj0E
AwIDSAAwRQIhAKUSaUMnkbvZOaPCPnzW1FxVVJMJMRepFTgCQ9Eog80bAiBKoPHL
IJzGv2uVMmt47P+ydhm1Sw+nLHUJ1CjB7PKVgQ==
-----END CERTIFICATE-----
</code></pre></td></tr></table>
</div>
</div><p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in yfhuang.pem -noout -text
</code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            2d:46:a3:89:84:fb:1d:30:fc:70:94:fb:1c:73:0a:0b:d5:66:ef:2b
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = yfhuang
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:eb:47:a1:a1:17:46:54:06ğŸ†cc:da:cb:87:f0:
                    63:75:a9:59:c5:08:25:ea:f6:06:55:e2:23:e4:71:
                    32:ee:7f:02:a2:8f:4c:d5:0d:dc:35:fe:e3:3b:46:
                    c3:dc:11:8b:41:1a:fe:28:7d:15:bd:50:4a:e6:49:
                    3e:7c:5f:29:ca
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                A0:97:34:B1:B5:67:58:1E:E0:93:FC:35:B0:98:16:85:D6:2F:A9:86
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;yfhuang&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;leader_car_department&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:a5:12:69:43:27:91:bb:d9:39:a3:c2:3e:7c:
         d6:d4:5c:55:54:93:09:31:17:a9:15:38:02:43:d1:28:83ğŸ’¿
         1b:02:20:4a:a0:f1:cb:20:9c:c6:bf:6b:95:32:6b:78:ec:ff:
         b2:76:19:b5:4b:0f:a7:2c:75:09:d4:28:c1:ec:f2:95:81
PS C:\Users\Bun\Desktop&gt; openssl x509 -in songjian.pem -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            7b:b9:25:d6:2c:fb:00:2f:89:88:8e:15:f8:64:12:14:c5:e1:ef:d8
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = songjian
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c1:b3:8f:e5:5e:be:2c:04:0d:ec:52:cb:79:1d:
                    2c:35:72:16:9b:21:b4:f5:37:c4:e3:7e:1e:ff:b6:
                    db:8b:f9:89:b3:87:35:9f:af:fc:87:72:31:28:21:
                    37:0c:e4:30:88:7e:44:6c:73:6e:49:ad:e3:f1:76:
                    85:3c:85:84:e3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                8B:12:5A:FC:C8:A8:9E:3B:B6:E0:92:84:19:8C:32:B6:7D:2B:6A:C2
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;songjian&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;worker&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:aa:fa:35:16:8b:68:60:be:34:2f:00:5a:25:
         51:e8:aa:88:6c:bd:fe:03:6c:b4:b4:c3:d8:3f:f3:6f:b1:11:
         5c:02:20:04:07:c9:c2:9a:94:63:61:74:ef:7a:47:2d:a9:3b:
         4a:b7:29:0b:ba:dc:37:a8:97:d6:ef:00:85:86:7a:7c:55
PS C:\Users\Bun\Desktop&gt; openssl x509 -in yfhuang.pem -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            2d:46:a3:89:84:fb:1d:30:fc:70:94:fb:1c:73:0a:0b:d5:66:ef:2b
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 10:03:00 2020 GMT
            Not After : Oct 16 10:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = yfhuang
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:eb:47:a1:a1:17:46:54:06ğŸ†cc:da:cb:87:f0:
                    63:75:a9:59:c5:08:25:ea:f6:06:55:e2:23:e4:71:
                    32:ee:7f:02:a2:8f:4c:d5:0d:dc:35:fe:e3:3b:46:
                    c3:dc:11:8b:41:1a:fe:28:7d:15:bd:50:4a:e6:49:
                    3e:7c:5f:29:ca
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                A0:97:34:B1:B5:67:58:1E:E0:93:FC:35:B0:98:16:85:D6:2F:A9:86
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;yfhuang&#34;,&#34;hf.Type&#34;:&#34;client&#34;,&#34;usertype&#34;:&#34;leader_car_department&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:a5:12:69:43:27:91:bb:d9:39:a3:c2:3e:7c:
         d6:d4:5c:55:54:93:09:31:17:a9:15:38:02:43:d1:28:83ğŸ’¿
         1b:02:20:4a:a0:f1:cb:20:9c:c6:bf:6b:95:32:6b:78:ec:ff:
         b2:76:19:b5:4b:0f:a7:2c:75:09:d4:28:c1:ec:f2:95:81
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥è§‚å¯Ÿåˆ°ä¸Šé¢ä¸¤ä¸ªè¯ä¹¦è½¬æ¢ä¹‹åçš„æ–‡æœ¬ä¸­æœ€åçš„attrsä¸­çš„usertypeæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜ï¼Œæˆ‘ä»¬çš„usertypeå·²ç»enrollåˆ°è¯ä¹¦ä¸­äº†ï¼Œä¹Ÿå°±èƒ½åœ¨é“¾ç ä¸­è¯»å–äº†</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªåœ¨æ³¨å†Œç”¨æˆ·çš„æ—¶å€™Enrollçš„æ—¶å€™æ²¡æœ‰æŒ‡å®šå°†è‡ªå®šä¹‰çš„å±æ€§åŠ å…¥è¯ä¹¦çš„ä¾‹å­(æ³¨æ„ä¸€ä¸ªhahaç”¨æˆ·)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">SPDX-License-Identifier: Apache-2.0
</span><span class="cm">*/</span>

<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.example.Common.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.gateway.Wallet.Identity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.Enrollment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric.sdk.security.CryptoSuiteFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.EnrollmentRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.HFCAClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hyperledger.fabric_ca.sdk.RegistrationRequest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RegisterUser</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;org.hyperledger.fabric.sdk.service_discovery.as_localhost&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Create a CA client for interacting with the CA.
</span><span class="c1"></span>        <span class="n">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pemFile&#34;</span><span class="o">,</span> <span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">CERTIFICATION_PATH</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;allowAllHostNames&#34;</span><span class="o">,</span> <span class="s">&#34;true&#34;</span><span class="o">);</span>
        <span class="n">HFCAClient</span> <span class="n">caClient</span> <span class="o">=</span> <span class="n">HFCAClient</span><span class="o">.</span><span class="na">createNewInstance</span><span class="o">(</span><span class="n">EnrollAdmin</span><span class="o">.</span><span class="na">PATH_AND_PORT</span><span class="o">,</span> <span class="n">props</span><span class="o">);</span>
        <span class="n">CryptoSuite</span> <span class="n">cryptoSuite</span> <span class="o">=</span> <span class="n">CryptoSuiteFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getCryptoSuite</span><span class="o">();</span>
        <span class="n">caClient</span><span class="o">.</span><span class="na">setCryptoSuite</span><span class="o">(</span><span class="n">cryptoSuite</span><span class="o">);</span>

        <span class="c1">// Create a wallet for managing identities
</span><span class="c1"></span>        <span class="n">Wallet</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">Wallet</span><span class="o">.</span><span class="na">createFileSystemWallet</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;src/main/resources/wallet&#34;</span><span class="o">));</span>

        <span class="c1">// Check to see if we&#39;ve already enrolled the user.
</span><span class="c1"></span>        <span class="kt">boolean</span> <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;An identity for the user \&#34;haha\&#34; already exists in the wallet&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">userExists</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">exists</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">userExists</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;\&#34;admin\&#34; needs to be enrolled and added to the wallet first&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Identity</span> <span class="n">adminIdentity</span> <span class="o">=</span> <span class="n">wallet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
        <span class="n">org</span><span class="o">.</span><span class="na">hyperledger</span><span class="o">.</span><span class="na">fabric</span><span class="o">.</span><span class="na">sdk</span><span class="o">.</span><span class="na">User</span> <span class="n">admin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">affiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">mspId</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">enrollment</span><span class="o">(</span><span class="n">adminIdentity</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">RegistrationRequest</span> <span class="n">registrationRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RegistrationRequest</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setAffiliation</span><span class="o">(</span><span class="s">&#34;org1.department1&#34;</span><span class="o">);</span>
        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">setEnrollmentID</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">);</span>
        <span class="c1">//registerçš„æ—¶å€™è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ç±»å‹
</span><span class="c1"></span>        <span class="n">registrationRequest</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">Attribute</span><span class="o">(</span><span class="s">&#34;usertype&#34;</span><span class="o">,</span><span class="s">&#34;leader_car_department&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">enrollmentSecret</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">registrationRequest</span><span class="o">,</span> <span class="n">admin</span><span class="o">);</span>
        <span class="n">Enrollment</span> <span class="n">enrollment</span> <span class="o">=</span> <span class="n">caClient</span><span class="o">.</span><span class="na">enroll</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">enrollmentSecret</span><span class="o">);</span>
        <span class="n">Identity</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="na">createIdentity</span><span class="o">(</span><span class="s">&#34;Org1MSP&#34;</span><span class="o">,</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getCert</span><span class="o">(),</span> <span class="n">enrollment</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="n">wallet</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Successfully enrolled user \&#34;haha\&#34; and imported it into the wallet&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢æ˜¯è¿™ä¸ªç”¨æˆ·çš„è¯ä¹¦ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">-----BEGIN CERTIFICATE-----
MIICjDCCAjOgAwIBAgIUJrH6/14VpN4DZAG/b3H7TwFxm0wwCgYIKoZIzj0EAwIw
czELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh
biBGcmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMT
E2NhLm9yZzEuZXhhbXBsZS5jb20wHhcNMjAxMDE2MTEwMzAwWhcNMjExMDE2MTEw
ODAwWjBBMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UECxMLZGVw
YXJ0bWVudDExDTALBgNVBAMTBGhhaGEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNC
AATSOOKZ0tB7IRD97e+G8Rbka058hcLr+euj1WHNLipOOKeBvLFocCKMML2dL8hP
2mkndM1zj00YAkVP8yTwO97zo4HWMIHTMA4GA1UdDwEB/wQEAwIHgDAMBgNVHRMB
Af8EAjAAMB0GA1UdDgQWBBSuIp0UQPrfvmgbJ5iNhOZUh2e/1zArBgNVHSMEJDAi
gCAogZum/KZqSDkXogXJ5G8VAqmWjPKA2V0SvlV1HcpzVDBnBggqAwQFBgcIAQRb
eyJhdHRycyI6eyJoZi5BZmZpbGlhdGlvbiI6Im9yZzEuZGVwYXJ0bWVudDEiLCJo
Zi5FbnJvbGxtZW50SUQiOiJoYWhhIiwiaGYuVHlwZSI6ImNsaWVudCJ9fTAKBggq
hkjOPQQDAgNHADBEAiAYderD2wOsojvdK5k1zYyDLtK73KIYLS5dim02Oz3+BQIg
DjZ1y7kctNRyWJ3uXPJlZWISnwD3fpzp8QccIKE5bUY=
-----END CERTIFICATE-----
</code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨opensslå·¥å…·ï¼Œæ‰§è¡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">openssl x509 -in haha.pem -noout -text
</code></pre></td></tr></table>
</div>
</div><p>è½¬æ¢å¾—åˆ°æ–‡æœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            26:b1:fa:ff:5e:15:a4ğŸ‡©ğŸ‡ª03:64:01:bf:6f:71:fb:4f:01:71:9b:4c
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, ST = California, L = San Francisco, O = org1.example.com, CN = ca.org1.example.com
        Validity
            Not Before: Oct 16 11:03:00 2020 GMT
            Not After : Oct 16 11:08:00 2021 GMT
        Subject: OU = client + OU = org1 + OU = department1, CN = haha
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:d2:38:e2:99:d2:d0:7b:21:10:fd:ed:ef:86:f1:
                    16:e4:6b:4e:7c:85:c2:eb:f9:eb:a3:d5:61ğŸ’¿2e:
                    2a:4e:38:a7:81:bc:b1:68:70:22:8c:30:bd:9d:2f:
                    c8:4f:da:69:27:74:cd:73:8f:4d:18:02:45:4f:f3:
                    24:f0:3bğŸ‡©ğŸ‡ªf3
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                AE:22:9D:14:40:FA:DF:BE:68:1B:27:98:8D:84:E6:54:87:67:BF:D7
            X509v3 Authority Key Identifier:
                keyid:28:81:9B:A6:FC:A6:6A:48:39:17:A2:05:C9:E4:6F:15:02:A9:96:8C:F2:80:D9:5D:12:BE:55:75:1D:CA:73:54

            1.2.3.4.5.6.7.8.1:
                {&#34;attrs&#34;:{&#34;hf.Affiliation&#34;:&#34;org1.department1&#34;,&#34;hf.EnrollmentID&#34;:&#34;haha&#34;,&#34;hf.Type&#34;:&#34;client&#34;}}
    Signature Algorithm: ecdsa-with-SHA256
         30:44:02:20:18:75:ea:c3:db:03:ac:a2:3b:dd:2b:99:35ğŸ’¿
         8c:83:2e:d2:bb:dc:a2:18:2d:2e:5d:8a:6d:36:3b:3d:fe:05:
         02:20:0e:36:75:cb:b9:1c:b4:d4:72:58:9d:ee:5c:f2:65:65:
         62:12:9f:00:f7:7e:9c:e9:f1:07:1c:20:a1:39:6d:46
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°attrsä¸­å¹¶æ²¡æœ‰åŠ å…¥usertype</p>
</blockquote>
<p>å½“ç„¶é“¾ç çš„æ§åˆ¶è¿˜å¯ä»¥ä½¿ç”¨æ–­è¨€çš„æ–¹å¼è¿›è¡Œ</p>
<p>å¥½äº†ï¼Œå¤§åŠŸå‘Šæˆï¼ï¼ï¼ï¼</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">VegeBun-csj</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        29088-29
        
    </span>
  </p>
  
  
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">Reward</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/path/to/your/wechat-qr-code.png">
        <span>wechat</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/path/to/your/alipay-qr-code.png">
        <span>alipay</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">åŒºå—é“¾</a>
          <a href="/tags/golang/">golang</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/fabricnodesdk/%E4%BA%A4%E6%98%93invoke%E7%9A%84%E4%BD%BF%E7%94%A8/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">äº¤æ˜“invokeçš„ä½¿ç”¨</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/fabricnodesdk/ccp-connection-file%E7%9A%84%E8%AE%BE%E7%BD%AE/">
            <span class="next-text nav-default">ccpæ–‡ä»¶çš„è®¾ç½®</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  
  <div id="vcomments"></div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'ä½ çš„appId',
        appKey: 'ä½ çš„appKey',
        notify:  false ,
        verify:  false ,
        avatar:'mm',
        placeholder: 'è¯´ç‚¹ä»€ä¹ˆå§...',
        visitor:  false 
    });
  </script>

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="csj1071285741@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/VegeBun-csj" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2019 - 
    2020<span class="heart"><i class="iconfont icon-heart"></i></span><span>VegeBun-csj</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
